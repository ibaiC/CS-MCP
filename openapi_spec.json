{"openapi":"3.1.0","info":{"title":"Cobalt Strike API","description":"Cobalt Strike provides a REST API that can be called directly to configure and access the product features and to manage an operate the Beacons.","termsOfService":"https://www.fortra.com/terms-of-service","contact":{"name":"Support","url":"https://www.cobaltstrike.com/support"},"license":{"name":"Proprietary License","url":"https://www.cobaltstrike.com/license"},"version":"1.0.0-BETA"},"servers":[{"url":"https://18.171.134.255:50443","description":"Generated server url"}],"tags":[{"name":"Security"},{"name":"BeaconInfo"},{"name":"ConsoleCommand"},{"name":"JobsAndTasks"},{"name":"CredsAndTokens"},{"name":"FileAndRegistry"},{"name":"NetworkRecon"},{"name":"PayloadAndArtifacts"},{"name":"Pivoting"},{"name":"ProcessAndExecution"},{"name":"Capture"},{"name":"Tunneling"},{"name":"BeaconConfig"},{"name":"Listeners"},{"name":"ServerConfig"}],"paths":{"/api/v1/listeners/userDefinedC2/{name}":{"put":{"tags":["Listeners"],"summary":"Update UDC2 Listener","description":"Modify the configuration of a User Defined C2 (UDC2) listener.","operationId":"updateUserDefinedC2Listener","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDefinedC2ListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDefinedC2ListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/tcp/{name}":{"put":{"tags":["Listeners"],"summary":"Update TCP Listener","description":"Modify the configuration of a TCP listener.","operationId":"updateTcpListener","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TcpListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TcpListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/smb/{name}":{"put":{"tags":["Listeners"],"summary":"Update SMB Listener","description":"Modify the configuration of an SMB listener.","operationId":"updateSmbListener","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SmbListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SmbListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/https/{name}":{"put":{"tags":["Listeners"],"summary":"Update HTTPS Listener","description":"Modify the configuration of an HTTPS listener.","operationId":"updateHttpsListener","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HttpsListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/HttpsListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/http/{name}":{"put":{"tags":["Listeners"],"summary":"Update HTTP Listener","description":"Modify the configuration of an HTTP listener.","operationId":"updateHttpListener","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HttpListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/HttpListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/foreignHttps/{name}":{"put":{"tags":["Listeners"],"summary":"Update Foreign HTTPs Listener","description":"Modify the configuration of a Foreign HTTPS listener.","operationId":"updateForeignHttpsListener","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForeignHttpsListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ForeignHttpsListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/foreignHttp/{name}":{"put":{"tags":["Listeners"],"summary":"Update Foreign HTTP Listener","description":"Modify the configuration of a Foreign HTTP listener.","operationId":"updateForeignHttpListener","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForeignHttpListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ForeignHttpListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/externalC2/{name}":{"put":{"tags":["Listeners"],"summary":"Update External C2 Listener","description":"Modify the configuration of an External C2 listener.","operationId":"updateExternalC2Listener","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExternalC2ListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ExternalC2ListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/dns/{name}":{"put":{"tags":["Listeners"],"summary":"Update DNS Listener","description":"Modify the configuration of a DNS listener.","operationId":"updateDnsListener","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DnsListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/DnsListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/c2/host":{"get":{"tags":["BeaconConfig"],"summary":"Get Beacon Callback Information","description":"Retrieve host callback information from a Beacon.\n\nRelated CS Console Command: beacon_config","operationId":"getHostCallbackInformation","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]},"put":{"tags":["BeaconConfig"],"summary":"Update Host in Beacon Callback hosts list","description":"Change the host/uri of one or more existing hosts/uris in the host list.\n\nRelated CS Console Command: beacon_config","operationId":"updateHostCallbackInfo","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HostCallbackUpdateDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]},"post":{"tags":["BeaconConfig"],"summary":"Add Host to Beacon Callback hosts list","description":"Add one or more hosts/uris to the Beacons callback host list.\n\nRelated CS Console Command: beacon_config","operationId":"addHostCallbackInformation","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HostCallbackAddDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]},"delete":{"tags":["BeaconConfig"],"summary":"Delete Host","description":"Remove a host from the host list.\n\nRelated CS Console Command: beacon_config","operationId":"removeHostCallback","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HostCallbackRemoveDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/tasks/{taskId}/log":{"post":{"tags":["JobsAndTasks"],"summary":"Log Message","description":"Publishes an output message to the Beacon/task transcript.","operationId":"log","parameters":[{"name":"taskId","in":"path","description":"Task id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublishOutputDto"}}},"required":true},"responses":{"200":{"description":"OK"}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/tasks/{taskId}/error":{"post":{"tags":["JobsAndTasks"],"summary":"Log Error","description":"Publishes an error message to the Beacon/task transcript.","operationId":"error","parameters":[{"name":"taskId","in":"path","description":"Task id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PublishOutputDto"}}},"required":true},"responses":{"200":{"description":"OK"}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/payloads/generate/stager":{"post":{"tags":["PayloadAndArtifacts"],"summary":"Create Stager Payload","description":"Generate a Stager Payload from a Cobalt Strike Listener and save it to the serverside artifacts.","operationId":"generateStagerPayload","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayloadStagerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PayloadStagerResultDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/payloads/generate/stageless":{"post":{"tags":["PayloadAndArtifacts"],"summary":"Create Stageless Payload","description":"Generate a Stageless Payload from a Cobalt Strike Listener and save it to the serverside artifacts.","operationId":"generateStagelessPayload","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PayloadDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PayloadResultDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/userDefinedC2":{"post":{"tags":["Listeners"],"summary":"Add UDC2 Listener","description":"Add a new User Defined C2 (UDC2) listener.","operationId":"addUserDefinedC2Listener","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDefinedC2ListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/UserDefinedC2ListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/tcp":{"post":{"tags":["Listeners"],"summary":"Add TCP Listener","description":"Add a new TCP listener.","operationId":"addTcpListener","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TcpListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TcpListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/smb":{"post":{"tags":["Listeners"],"summary":"Add SMB Listener","description":"Add a new SMB listener.","operationId":"addSmbListener","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SmbListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/SmbListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/https":{"post":{"tags":["Listeners"],"summary":"Add HTTPS Listener","description":"Add a new HTTPS listener.","operationId":"addHttpsListener","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HttpsListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/HttpsListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/http":{"post":{"tags":["Listeners"],"summary":"Add HTTP Listener","description":"Add a new HTTP listener.","operationId":"addHttpListener","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HttpListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/HttpListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/foreignHttps":{"post":{"tags":["Listeners"],"summary":"Add Foreign HTTPS Listener","description":"Add a new Foreign HTTPS listener.","operationId":"addForeignHttpsListener","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForeignHttpsListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ForeignHttpsListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/foreignHttp":{"post":{"tags":["Listeners"],"summary":"Add Foreign HTTP Listener","description":"Add a new Foreign HTTP listener.","operationId":"addForeignHttpListener","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForeignHttpListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ForeignHttpListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/externalC2":{"post":{"tags":["Listeners"],"summary":"Add External C2 Listener","description":"Add a new External C2 listener.","operationId":"addExternalC2Listener","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExternalC2ListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ExternalC2ListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/dns":{"post":{"tags":["Listeners"],"summary":"Add DNS Listener","description":"Add a new DNS listener.","operationId":"addDnsListener","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DnsListenerDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/DnsListenerDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/data/credentials":{"get":{"tags":["CredsAndTokens"],"summary":"List Credentials","description":"List all credentials in the credentials data model.","operationId":"listCredentials","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CredentialDto"}}}}}},"security":[{"BearerAuthentication":[]}]},"post":{"tags":["CredsAndTokens"],"summary":"Add Credential","description":"Add a credential into the credentials data model.","operationId":"addCredential","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CredentialDto"}}},"required":true},"responses":{"200":{"description":"OK"}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/tokenStore":{"post":{"tags":["CredsAndTokens"],"summary":"List Tokens","description":"List the tokens currently available in the token store for the specified Beacon.\n\nRelated CS Console Command: token-store show","operationId":"listTokenStore","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/syscallMethod":{"get":{"tags":["BeaconConfig"],"summary":"Get Syscall Method","description":"Query the current syscall method.","operationId":"getSyscallMethod","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]},"post":{"tags":["BeaconConfig"],"summary":"Set Syscall Method","description":"Change the syscall method at runtime.","operationId":"setSyscallMethod","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SyscallMethodDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/spoofedArguments":{"get":{"tags":["BeaconConfig"],"summary":"List Argue / Command Line Argument Spoofing ","description":"List argument spoofing configuration.\n\nRelated CS Console Command: argue list","operationId":"listSpoofedArguments","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]},"post":{"tags":["BeaconConfig"],"summary":"Add Command Line Argument Spoofing ","description":"Add Command Line Argument Spoofing entry.\n\nRelated CS Console Command: argue add","operationId":"addSpoofedArguments","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SpoofedArgumentsAddDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]},"delete":{"tags":["BeaconConfig"],"summary":"Remove Argument Spoofing Configuration","description":"Remove Command Line Argument Spoofing entry.\n\nRelated CS Console Command: argue remove","operationId":"removeSpoofedArguments","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SpoofedArgumentsRemoveDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/spawnto":{"post":{"tags":["BeaconConfig"],"summary":"Set executable that is used when spawning","description":"Sets the executable Beacon spawns x86 and x64 shellcode into.\nYou must specify a full-path. Environment variables are OK (e.g., %windir%\\sysnative\\rundll32.exe).\nDo not reference %windir%\\system32\\ directly. This path is different depending on whether or not Beacon is x86 or x64. Use %windir%\\sysnative\\ and %windir%\\syswow64\\ instead.\nBeacon will map %windir%\\syswow64\\ to system32 when WOW64 is not present.\n\nRelated CS Console Command: spawnto","operationId":"setSpawnTo","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SpawnToDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]},"delete":{"tags":["BeaconConfig"],"summary":"Reset the executable that is used when spawning to default","description":"Resets the executable Beacon spawns x86 and x64 shellcode into to the value defined in the Malleable profile.\n\nRelated CS Console Command: spawnto","operationId":"unsetSpawnTo","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/sleepTime":{"post":{"tags":["BeaconConfig"],"summary":"Set Sleep","description":"Change the communication interval for Beacon calls home.","operationId":"setSleepTime","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SleepDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/ppid":{"post":{"tags":["BeaconConfig"],"summary":"Set Initial Beacon PID","description":"Use specified PID as parent for processes Beacon launches.","operationId":"setPpid","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PpidDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]},"delete":{"tags":["BeaconConfig"],"summary":"Reset the specified parent PID","description":"Reset the specified parent PID.","operationId":"unsetPpid","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/jobs":{"post":{"tags":["JobsAndTasks"],"summary":"List Active Jobs","description":"Lists jobs currently in progress.\n\nRelated CS Console Command: jobs","operationId":"listJobs","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/dnsMode":{"post":{"tags":["BeaconConfig"],"summary":"Set DNS Beacon Mode","description":"Sets Beacon's mode to exchange data with the end-user. \n - Mode dns is the DNS A record data channel. \n - Mode dns6 is the DNS AAAA record channel. \n - Mode dns-txt is the DNS TXT record data channel. \n\nThe default is the DNS TXT record data channel.\nThis only has an effect on a DNS Beacon.","operationId":"setDnsMode","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DnsModeDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/c2/host/reset":{"post":{"tags":["BeaconConfig"],"summary":"Reset Hosts Stats","description":"Reset the status and/or statistics for callback hosts.\n\nRelated CS Console Command: beacon_config reset","operationId":"resetCallbackHost","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HostCallbackResetDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/c2/host/release":{"post":{"tags":["BeaconConfig"],"summary":"Release Host","description":"Release a host in the callback host list [Random and Round-Robin rotation only]. Multiple hosts can be used by way of a comma-separated list.\n\nRelated CS Console Command: beacon_config release","operationId":"releaseHostProfile","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HostCallbackReleaseDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/c2/host/hold":{"post":{"tags":["BeaconConfig"],"summary":"Hold Host","description":"Hold one or more hosts in the callback host list [Random and Round-Robin rotation only].\n\nRelated CS Console Command: beacon_config hold","operationId":"holdHostCallback","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HostCallbackHoldDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/c2/failoverNotification/enable":{"post":{"tags":["BeaconConfig"],"summary":"Enable Failover Notification","description":"Enable notifications from a Beacon [HTTP|DNS] when host rotation occurs from failover events.\n\nRelated CS Console Command: beacon_config failover_notification","operationId":"enableFailoverNotification","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/c2/failoverNotification/disable":{"post":{"tags":["BeaconConfig"],"summary":"Disable Failover Notification","description":"Disable notifications from a Beacon [HTTP|DNS] when host rotation occurs from failover events.\n\nRelated CS Console Command: beacon_config failover_notification","operationId":"disableFailoverNotification","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/blockdlls/enable":{"post":{"tags":["BeaconConfig"],"summary":"Enable Block Dlls","description":"Enable use of the BlockDLL feature. With BlockDLL, a Windows binary signature policy is used that blocks non-Microsoft DLLs from loading into the child process.\nThis feature requires Windows 10/Windows Server 2012 or later.\n\nRelated CS Console Command: blockdlls start","operationId":"enableBlockDlls","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/blockdlls/disable":{"post":{"tags":["BeaconConfig"],"summary":"Disable Block Dlls","description":"Disable use of the 'BlockDLL feature'. With BlockDLL, a Windows binary signature policy is used that blocks non-Microsoft DLLs from loading into the child process.\nThis feature requires Windows 10/Windows Server 2012 or later.\n\nRelated CS Console Command: blockdlls stop","operationId":"disableBlockDlls","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/beaconGate/enable":{"post":{"tags":["BeaconConfig"],"summary":"Enable Beacon Gate","description":"Enable the Beacon Gate functionality as specified in the profile at runtime.\n\nRelated CS Console Command: beacon_gate enable","operationId":"enableBeaconGate","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/beaconGate/disable":{"post":{"tags":["BeaconConfig"],"summary":"Disable Beacon Gate","description":"Disable the Beacon Gate functionality at runtime.\n\nRelated CS Console Command: beacon_gate disable","operationId":"disableBeaconGate","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/ssh":{"post":{"tags":["Pivoting"],"summary":"Connect via SSH using User/Password (Spawn)","description":"Spawn a temporary process to run an SSH client and attempt to login to the specified target.\n\nRelated CS Console Command: ssh-key","operationId":"spawnSsh","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SshSpawnDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/sshKey":{"post":{"tags":["Pivoting"],"summary":"Connect via SSH using Key (Spawn)","description":"Spawn a temporary process to run an SSH client and attempt to login to the specified target using an SSH key. The key file needs to be in the PEM format.  If the file is not in the PEM format then make a copy of the file and convert the copy with the following command: /usr/bin/ssh-keygen -f [/path/to/copy] -e -m pem -p.\n\nRelated CS Console Command: ssh-key","operationId":"spawnSshKey","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SshKeySpawnDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/shellcode":{"post":{"tags":["ProcessAndExecution"],"summary":"Execute Shellcode (Spawn)","description":"Spawn a process and inject shellcode into it.\n\nRelated CS Console Command: shspawn","operationId":"spawnShellcode","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShSpawnDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/screenwatch":{"post":{"tags":["Capture"],"summary":"Start Screenwatch (Spawn)","description":"Screenwatch sends a screenshot of the user's desktop (one per Beacon check-in) until terminated. If the user is idle, the screen watch DLL will take a new screenshot every three minutes. A new process is spawned and the Screenshot DLL is injected into it.\n\nScreenwatch is implemented as a job and can be stopped using the jobkill command or the /execute/jobStop route.\n\nRelated CS Console Command: screenwatch","operationId":"spawnScreenwatch","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/screenshot":{"post":{"tags":["Capture"],"summary":"Take Screenshot (Spawn)","description":"Takes a picture of the visible desktop and exit. A new process is spawned and the screenshot DLL  is injected into it.\n\nRelated CS Console Command: screenshot","operationId":"spawnScreenshot","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/pth":{"post":{"tags":["ProcessAndExecution"],"summary":"Pass-the-Hash (Spawn)","description":"Spawn a temporary process to generate AND impersonate a token. This command uses mimikatz to generate AND impersonate a token that uses the specified DOMAIN, user, and NTLM hash as single sign-on credentials. Beacon will pass this hash when you interact with network resources.\n\nRelated CS Console Command: pth","operationId":"spawnPth","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PthSpawnDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/printscreen":{"post":{"tags":["Capture"],"summary":"Print Screen (Spawn)","description":"A DLL is injected a newly spawned process, sends a PrintScr keypress and grab the screenshot from the clipboard. Will clear the clipboard contents after its done.\n\nRelated CS Console Command: printscreen","operationId":"spawnPrintScreen","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/powershell":{"post":{"tags":["ProcessAndExecution"],"summary":"Execute Managed Powershell (Spawn)","description":"Execute the command using powershell.\n\nRelated CS Console Command: powershell","operationId":"spawnPowerShell","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PowerShellDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/powershell/unmanaged":{"post":{"tags":["ProcessAndExecution"],"summary":"Execute unmanaged Powershell  / powerpick (Spawn)","description":"Execute the Powershell command using Unmanaged PowerShell. Unmanaged PowerShell is a way to run PowerShell scripts without powershell.exe. the code loads the .NET CLR, reflectively loads a .NET class through that CLR, and uses that .NET class to call APIs in the System.management.automation namespace to evaluate arbitrary PowerShell expressions.\n\nRelated CS Console Command: powerpick","operationId":"spawnUnmanagedPowerShell","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PowerPickDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/postExDll":{"post":{"tags":["CredsAndTokens"],"summary":"Execute PostEx DLL (Spawn)","description":"Spawn a temporary process and inject the postex DLL into it.\n\nRelated CS Console Command: spawn","operationId":"spawnPostExDll","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExecuteDllDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/portscan":{"post":{"tags":["NetworkRecon"],"summary":"Port Scan (Spawn)","description":"Spawn a temporary process, inject a portscan DLL into it and to run a portscan against the specified hosts. [targets] is a comma separated list of hosts to scan.\n\nRelated CS Console Command: portscan","operationId":"spawnPortScan","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PortScanSpawnDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/view":{"post":{"tags":["NetworkRecon"],"summary":"List Domain Hosts (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to list hosts on a domain.\n\nRelated CS Console Command: net view","operationId":"spawnNetView","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetViewDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/user":{"post":{"tags":["NetworkRecon"],"summary":"List Users (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to list users on a system.\n\nRelated CS Console Command: net user","operationId":"spawnNetUser","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetUserDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/user/detail":{"post":{"tags":["NetworkRecon"],"summary":"Get User (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to get information about a user.\n\nRelated CS Console Command: net user","operationId":"spawnNetUserDetail","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetUserDetailDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/time":{"post":{"tags":["NetworkRecon"],"summary":"Get System Time (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to show time for a target.\n\nRelated CS Console Command: net time","operationId":"spawnNetTime","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetTimeDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/share":{"post":{"tags":["NetworkRecon"],"summary":"List Shares (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to list shares on a target.\n\nRelated CS Console Command: net share","operationId":"spawnNetShare","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetShareDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/sessions":{"post":{"tags":["NetworkRecon"],"summary":"List Sessions (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to list sessions on a target.\n\nRelated CS Console Command: net sessions","operationId":"spawnNetSessions","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetSessionsDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/logons":{"post":{"tags":["NetworkRecon"],"summary":"List Logged in Users (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to list users logged onto a target.\n\nRelated CS Console Command: net logons","operationId":"spawnNetLogons","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetLogonsDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/localGroup":{"post":{"tags":["NetworkRecon"],"summary":"List Local Groups (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to enumerate local groups on a specific system.\n\nRelated CS Console Command: net localgroup","operationId":"spawnNetLocalGroup","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetLocalGroupDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/group":{"post":{"tags":["NetworkRecon"],"summary":"List Domain Groups (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to enumerate groups on a domain controller.\n\nRelated CS Console Command: net group","operationId":"spawnNetGroup","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetGroupDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/domainTrusts":{"post":{"tags":["NetworkRecon"],"summary":"List Domain Trusts (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to list domain trusts for the specified domain.\n\nRelated CS Console Command: net domain_trusts","operationId":"spawnNetDomainTrusts","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetDomainTrustsDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/domainControllers":{"post":{"tags":["NetworkRecon"],"summary":"List Domain Controllers Hosts (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to list hosts from the Domain Controllers group on the specified domain.\n\nRelated CS Console Command: net domain_controllers","operationId":"spawnNetDomainControllers","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetDomainControllersDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/dclist":{"post":{"tags":["NetworkRecon"],"summary":"List Domain Controllers (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to list domain controllers for the specified domain.\n\nRelated CS Console Command: net dclist","operationId":"spawnNetDcList","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetDcListDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/net/computers":{"post":{"tags":["NetworkRecon"],"summary":"List Specified Groups (Spawn)","description":"Spawn a temporary process and inject the network and host enumeration DLL into it to list hosts from the Domain Computers and Domain Controllers groups on the specified domain.\n\nRelated CS Console Command: net computers","operationId":"spawnNetComputers","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetComputersDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/mimikatz":{"post":{"tags":["CredsAndTokens"],"summary":"Mimikatz (Spawn)","description":"Spawn a temporary process to run a mimikatz command. \nUse ! to make mimikatz elevate to SYSTEM before it runs your command. Some commands require this.\nUse @ to make mimikatz impersonate Beacon's thread token before it runs your command. This is helpful for mimikatz commands that interact with remote systems (e.g., lsadump::dcsync)\nUse ; to separate multiple mimikatz commands.  The maximum length of the commands is 511 characters.\nCommand Example:   crypto::capi ; crypto::certificates /systemstore:local_machine /store:my /export.\n\nRelated CS Console Command: mimikatz","operationId":"spawnMimikatz","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MimikatzSpawnDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/logonPasswords":{"post":{"tags":["CredsAndTokens"],"summary":"Dump Credentials (Spawn)","description":"Spawn a temporary process to dump plaintext credentials and NTLM hashes. This action uses mimikatz and requires administrator privileges.\n\nRelated CS Console Command: logonpasswords","operationId":"spawnLogonPasswords","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/keylogger":{"post":{"tags":["Capture"],"summary":"Start Keylogger (Spawn)","description":"Keystroke logger to capture the keys pressed. A new process is spawned and the keylogger DLL is injected into it.\n\nThe Keylogger is implemented as a job and can be stopped using the jobkill command or the /execute/jobStop route.\n\nRelated CS Console Command: keylogger","operationId":"spawnKeylogger","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/hashdump":{"post":{"tags":["CredsAndTokens"],"summary":"HashDump (Spawn)","description":"Spawn a temporary process and inject an hashdump DLL into it. The hashdump DLL will dump password hashes (Warning: Injects into LSASS).\nThis action requires administrator privileges.\n\nRelated CS Console Command: hashdump","operationId":"spawnHashDump","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/dotnetAssembly":{"post":{"tags":["ProcessAndExecution"],"summary":"Execute .NET assembly  (Spawn)","description":"Spawns a local .NET executable assembly as a Beacon post-exploitation job.","operationId":"spawnDotNetAssembly","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExecuteAssemblyDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/dcsync":{"post":{"tags":["CredsAndTokens"],"summary":"DCSYNC (Spawn)","description":"Spawn a temporary process to extract the NTLM password hash for domain users from the domain controller using mimikatz's DCSYNC. Specify a user to get their hash only.\nThis command requires a domain administrator trust relationship.\n\nRelated CS Console Command: dcsync","operationId":"spawnDcSync","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DcSyncSpawnDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/command/shell":{"post":{"tags":["ProcessAndExecution"],"summary":"Run Shell Command (Spawn)","description":"Execute the command using cmd.exe.\n\nRelated CS Console Command: shell","operationId":"spawnShellCommand","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShellDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/command/run":{"post":{"tags":["ProcessAndExecution"],"summary":"Run (Spawn)","description":"Execute the program. Returns output.\n\nRelated CS Console Command: run","operationId":"spawnRunCommand","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RunDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/command/runUnder":{"post":{"tags":["ProcessAndExecution"],"summary":"Run under parentPID (Spawn)","description":"Attempt to execute a program with the specified PID as its parent.\n\nRelated CS Console Command: runu","operationId":"spawnRunCommandUnder","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RunUDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/command/runNoOutput":{"post":{"tags":["CredsAndTokens"],"summary":"Run without output (Spawn)","description":"Execute the program (without a shell). Does not block or return output.\n\nRelated CS Console Command: execute","operationId":"spawnRunCommandNoOutput","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExecuteDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/command/runAs":{"post":{"tags":["ProcessAndExecution"],"summary":"Run As (Spawn)","description":"Attempt to execute a program as another user.\n\nRelated CS Console Command: runas","operationId":"spawnRunCommandAs","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RunAsDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/chromedump":{"post":{"tags":["CredsAndTokens"],"summary":"Chromedump (Spawn)","description":"Spawn a temporary process to recover credential material from Google Chrome. This command will use Mimikatz to recover the credential material and should be run under a user context.\n\nRelated CS Console Command: chromedump","operationId":"spawnChromeDump","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/beacon":{"post":{"tags":["ProcessAndExecution"],"summary":"Execute Beacon Shellcode (Spawn)","description":"Spawn an x86 or x64 process and inject shellcode for the listener.\n\nRelated CS Console Command: spawn","operationId":"spawnBeacon","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SpawnDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/beacon/under":{"post":{"tags":["ProcessAndExecution"],"summary":"Execute Beacon Shellcode under parentPID (Spawn)","description":"Attempt to spawn a session with the specified PID as its parent.\n\nRelated CS Console Command: spawnu","operationId":"spawnBeaconUnder","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SpawnuDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/spawn/beacon/asUser":{"post":{"tags":["ProcessAndExecution"],"summary":"Execute Beacon Shellcode as User (Spawn)","description":"Spawn a process as another user and Beacon inject shellcode for the listener.\n\nRelated CS Console Command: spawnas","operationId":"spawnBeaconAsUser","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SpawnBeaconAsDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/remoteExec/command":{"get":{"tags":["ProcessAndExecution"],"summary":"List Remote Command Execution methods","description":"List available remote command execution methods for running a remote command.\n\nRelated CS Console Command: remote-exec","operationId":"listRemoteExecutionCommandMethods","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RemoteExecInfoDto"}}}}}},"security":[{"BearerAuthentication":[]}]},"post":{"tags":["ProcessAndExecution"],"summary":"Remote Command Execution (remote-exec)","description":"Execute a command on a target via specific remote execution method.  Could use spawn or inject depending on chosen method.\n\nRelated CS Console Command: remote-exec","operationId":"remoteExecuteCommand","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RemoteExecDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/remoteExec/beacon":{"get":{"tags":["ProcessAndExecution"],"summary":"List Remote Beacon Execution methods","description":"List available remote command execution methods for running Beacon remotely.\n\nRelated CS Console Command: jump","operationId":"listRemoteExecuteBeaconMethods","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RemoteExploitInfoDto"}}}}}},"security":[{"BearerAuthentication":[]}]},"post":{"tags":["ProcessAndExecution"],"summary":"Remote Beacon Execution (jump)","description":"Execute a Beacon session on a remote target with the specified remote execution method. Could use spawn or inject depending on chosen method.\n\nRelated CS Console Command: jump","operationId":"remoteExecuteBeacon","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JumpDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/note":{"post":{"tags":["BeaconInfo"],"summary":"Set Note","description":"Assigns a note to the Beacon.\n\nRelated CS Console Command: note","operationId":"setNote","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NoteDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/ssh":{"post":{"tags":["Pivoting"],"summary":"Connect via SSH using User/Password (Inject)","description":"Inject into the specified process to run an SSH client and attempt to login to the specified target.\n\nRelated CS Console Command: ssh-key","operationId":"injectSsh","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SshInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/sshKey":{"post":{"tags":["Pivoting"],"summary":"Connect via SSH using Key (Inject)","description":"Inject into the specified process to run an SSH client and attempt to login to the specified target using an SSH key. The key file needs to be in the PEM format.  If the file is not in the PEM format then make a copy of the file and convert the copy with the following command: /usr/bin/ssh-keygen -f [/path/to/copy] -e -m pem -p.\n\nRelated CS Console Command: ssh-key","operationId":"injectSshKey","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SshKeyInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/shellcode":{"post":{"tags":["ProcessAndExecution"],"summary":"Execute Shellcode (Inject)","description":"Open the process and inject shellcode into it.\n\nRelated CS Console Command: shinject","operationId":"injectShellcode","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/screenwatch":{"post":{"tags":["Capture"],"summary":"Start Screenwatch (Inject)","description":"Screenwatch sends a screenshot of the user's desktop (one per Beacon check-in) until terminated. If the user is idle, the screen watch DLL will take a new screenshot every three minutes. The Screenshot DLL is injected in the specified process.\n\nScreenwatch is implemented as a job and can be stopped using the jobkill command or the /execute/jobStop route.\n\nRelated CS Console Command: screenwatch","operationId":"injectScreenwatch","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScreenwatchInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/screenshot":{"post":{"tags":["Capture"],"summary":"Take Screenshot (Inject)","description":"Takes a picture of the visible desktop and exit. The Screenshot DLL is injected in the specified process.\n\nRelated CS Console Command: screenshot","operationId":"injectScreenshot","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScreenshotInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/pth":{"post":{"tags":["ProcessAndExecution"],"summary":"Pass-the-Hash (Inject)","description":"Inject into the specified process to generate AND impersonate a token. This command uses mimikatz to generate AND impersonate a token that uses the specified DOMAIN, user, and NTLM hash as single sign-on credentials. Beacon will pass this hash when you interact with network resources.\n\nRelated CS Console Command: pth","operationId":"injectPth","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PthInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/printscreen":{"post":{"tags":["Capture"],"summary":"Print Screen (Inject)","description":"A DLL is injected in the specified process, sends a PrintScr keypress and grab the screenshot from the clipboard. Will clear the clipboard contents after its done.\n\nRelated CS Console Command: printscreen","operationId":"injectPrintScreen","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PrintScreenInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/powershell/unmanaged":{"post":{"tags":["ProcessAndExecution"],"summary":"Execute unmanaged Powershell  / psinject (Inject)","description":"Inject Unmanaged Powershell into a specific process and execute the specified command.\n\nRelated CS Console Command: psinject","operationId":"injectUnmanagedPowerShell","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PowerShellInject"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/postExDll":{"post":{"tags":["CredsAndTokens"],"summary":"Inject PostEx Dll (Inject)","description":"Inject the provided postex DLL into the specified process.","operationId":"injectPostExDll","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExecuteDllInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/portscan":{"post":{"tags":["NetworkRecon"],"summary":"Port Scan (Inject)","description":"Inject a portscan DLL into the specified process to run a portscan against the specified hosts.\n\nRelated CS Console Command: portscan","operationId":"injectPortScan","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PortScanInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/view":{"post":{"tags":["NetworkRecon"],"summary":"List Domain Hosts (Inject)","description":"Inject the network and host enumeration DLL into the specified process to list hosts on a domain.\n\nRelated CS Console Command: net view","operationId":"injectNetView","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetViewInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/user":{"post":{"tags":["NetworkRecon"],"summary":"List Users (Inject)","description":"Inject the network and host enumeration dll into the specified process to list users on a system.\n\nRelated CS Console Command: net user","operationId":"injectNetUser","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetUserInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/user/detail":{"post":{"tags":["NetworkRecon"],"summary":"Get User (Inject)","description":"Inject the network and host enumeration DLL into the specified process to get information about a user.\n\nRelated CS Console Command: net user","operationId":"injectNetUserDetail","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetUserDetailInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/time":{"post":{"tags":["NetworkRecon"],"summary":"Get System Time (Inject)","description":"Inject the network and host enumeration DLL into the specified process to  show time for a target.\n\nRelated CS Console Command: net time","operationId":"injectNetTime","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetTimeInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/share":{"post":{"tags":["NetworkRecon"],"summary":"List Shares (Inject)","description":"Inject the network and host enumeration DLL into the specified process to list shares on a target.\n\nRelated CS Console Command: net share","operationId":"injectNetShare","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetShareInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/sessions":{"post":{"tags":["NetworkRecon"],"summary":"List Sessions (Inject)","description":"Inject the network and host enumeration DLL into the specified process to list sessions on a target.\n\nRelated CS Console Command: net sessions","operationId":"injectNetSessions","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetSessionsInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/logons":{"post":{"tags":["NetworkRecon"],"summary":"List Logged in Users (Inject)","description":"Inject the network and host enumeration DLL into the specified process to list users logged onto a target.\n\nRelated CS Console Command: net logons","operationId":"injectNetLogons","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetLogonsInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/localGroup":{"post":{"tags":["NetworkRecon"],"summary":"List Local Groups (Inject)","description":"Inject the network and host enumeration DLL into the specified process to enumerate local groups on a specific system.\n\nRelated CS Console Command: net localgroup","operationId":"injectNetLocalGroup","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetLocalGroupInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/group":{"post":{"tags":["NetworkRecon"],"summary":"List Domain Groups (Inject)","description":"Inject the network and host enumeration DLL into the specified process to enumerate groups on a domain controller.\n\nRelated CS Console Command: net group","operationId":"injectNetGroup","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetGroupInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/domainTrusts":{"post":{"tags":["NetworkRecon"],"summary":"List Domain Trusts (Inject)","description":"Inject the network and host enumeration DLL into the specified process to list domain trusts for the specified domain.\n\nRelated CS Console Command: net domain_trusts","operationId":"injectNetDomainTrusts","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetDomainTrustsInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/domainControllers":{"post":{"tags":["NetworkRecon"],"summary":"List Domain Controllers Hosts (Inject)","description":"Inject the network and host enumeration DLL into the specified process to list hosts from the Domain Controllers group on the specified domain.\n\nRelated CS Console Command: net domain_controllers","operationId":"injectNetDomainControllers","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetDomainControllersInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/dclist":{"post":{"tags":["NetworkRecon"],"summary":"List Domain Controllers (Inject)","description":"Inject the network and host enumeration DLL into the specified process to list domain controllers for the specified domain.\n\nRelated CS Console Command: net dclist","operationId":"injectNetDcList","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetDcListInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/net/computers":{"post":{"tags":["NetworkRecon"],"summary":"List Specified Groups (Inject)","description":"Inject the network and host enumeration DLL into the specified process to list hosts from the Domain Computers and Domain Controllers groups on the specified domain.\n\nRelated CS Console Command: net computers","operationId":"injectNetComputers","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NetComputersInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/mimikatz":{"post":{"tags":["CredsAndTokens"],"summary":"Mimikatz (Inject)","description":"Inject into the specified process to run a mimikatz command. \nUse ! to make mimikatz elevate to SYSTEM before it runs your command. Some commands require this.\nUse @ to make mimikatz impersonate Beacon's thread token before it runs your command. This is helpful for mimikatz commands that interact with remote systems (e.g., lsadump::dcsync)\nUse ; to separate multiple mimikatz commands.  The maximum length of the commands is 511 characters.\nCommand Example:   crypto::capi ; crypto::certificates /systemstore:local_machine /store:my /export.\n\nRelated CS Console Command: mimikatz","operationId":"injectMimikatz","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MimikatzInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/logonPasswords":{"post":{"tags":["CredsAndTokens"],"summary":"Dump Credentials (Inject)","description":"Inject into the specified process to dump plaintext credentials and NTLM hashes. This action uses mimikatz and requires administrator privileges.\n\nRelated CS Console Command: logonpasswords","operationId":"injectLogonPasswords","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogonPasswordsInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/loadDll":{"post":{"tags":["ProcessAndExecution"],"summary":"Load Library from disk (Inject)","description":"Load DLL into specified remote process via LoadLibrary(). The DLL must exist on the target.\n\nRelated CS Console Command: dllload","operationId":"injectLoadDll","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DllLoadDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/keylogger":{"post":{"tags":["Capture"],"summary":"Start Keylogger (Inject)","description":"Keystroke logger to capture the keys pressed. The keylogger DLL is injected in the specified process.\n\nThe Keylogger is implemented as a job and can be stopped using the jobkill command or the /execute/jobStop route.\n\nRelated CS Console Command: keylogger","operationId":"injectKeylogger","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KeyLoggerInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/hashdump":{"post":{"tags":["CredsAndTokens"],"summary":"HashDump (Inject)","description":"Inject the hashdump DLL into the specified process. The hashdump DLL will dump password hashes (Warning: Injects into LSASS).\nThis action requires administrator privileges.\n\nRelated CS Console Command: hashdump","operationId":"injectHashDump","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/HashDumpInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/dll":{"post":{"tags":["ProcessAndExecution"],"summary":"Load DLL via reflective DLL loading (Inject)","description":"Open the process and injects a Reflective DLL.\n\nRelated CS Console Command: dllinject","operationId":"injectDll","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DllInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/dcsync":{"post":{"tags":["CredsAndTokens"],"summary":"DCSYNC (Inject)","description":"Inject into the specified process to extract the NTLM password hash for domain users from the domain controller using mimikatz' DCSYNC. Specify a user to get their hash only.\nThis command requires a domain administrator trust relationship.\n\nRelated CS Console Command: dcsync","operationId":"injectDcSync","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DcSyncInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/chromedump":{"post":{"tags":["CredsAndTokens"],"summary":"Chromedump (Inject)","description":"Inject into the specified process to recover credential material from Google Chrome. This command will use Mimikatz to recover the credential material and should be run under a user context.\n\nRelated CS Console Command: chromedump","operationId":"injectChromeDump","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChromeDumpInjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/browserpivotStart":{"post":{"tags":["Tunneling"],"summary":"Start Browser Pivot (Inject)","description":"Start a Browser Pivot into the specified process. To hijack authenticated web sessions, make sure the process is an Internet Explorer tab. These processes have iexplore.exe as their parent process.\n\nRelated CS Console Command: browserpivot","operationId":"injectBrowserPivotStart","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BrowserPivotSetupDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/inject/beacon":{"post":{"tags":["ProcessAndExecution"],"summary":"Execute Beacon Shellcode (Inject)","description":"Open the process and inject shellcode to start a Beacon.\n\nRelated CS Console Command: inject","operationId":"injectBeacon","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InjectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/upload":{"post":{"tags":["FileAndRegistry"],"summary":"Upload File","description":"Upload a file to a host via the Beacon.\n\nRelated CS Console Command: upload","operationId":"executeUpload","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UploadDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/unlink":{"post":{"tags":["Pivoting"],"summary":"Disconnect Pivot Beacon","description":"Disconnect from a named pipe or TCP Beacon.\n\nRelated CS Console Command: unlink","operationId":"executeUnlink","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UnlinkDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/tokenStore/use":{"post":{"tags":["CredsAndTokens"],"summary":"Use Token","description":"Request a Beacon to use a token from the token store.\n\nRelated CS Console Command: token-store use","operationId":"executeTokenStoreUseToken","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenStoreUseDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/tokenStore/steal":{"post":{"tags":["CredsAndTokens"],"summary":"Steal and Store Token","description":"Request a Beacon to steal a token and store it in the token store.\n\nRelated CS Console Command: token-store steal","operationId":"executeTokenStoreStealToken","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenStoreStealDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/tokenStore/stealAndUse":{"post":{"tags":["CredsAndTokens"],"summary":"Steal and Use Token","description":"Request a Beacon to steal a token, store it and immediately apply it to the Beacon.\n\nRelated CS Console Command: token-store steal-and-use","operationId":"executeTokenStoreStealAndUseToken","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenStoreStealAndUseDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/tokenStore/remove":{"post":{"tags":["CredsAndTokens"],"summary":"Delete Token","description":"Request a Beacon to remove specific access tokens from the store.\n\nRelated CS Console Command: token-store remove","operationId":"executeTokenStoreRemoveToken","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenStoreRemoveDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/tokenStore/removeAll":{"post":{"tags":["CredsAndTokens"],"summary":"Delete All Tokens","description":"\"Request a Beacon to remove all tokens from the store.\n\nRelated CS Console Command: token-store remove-all\"","operationId":"executeTokenStoreRemoveAllTokens","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/timestomp":{"post":{"tags":["FileAndRegistry"],"summary":"Timestomp","description":"Update the Modified, Access, and Created times of source file to match those of destination file.\n\nRelated CS Console Command: timestomp","operationId":"executeTimestomp","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TimeStompDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/stealToken":{"post":{"tags":["CredsAndTokens"],"summary":"Steal Token","description":"Request a Beacon to steal a token from a process.\n\nRelated CS Console Command: steal_token","operationId":"executeStealToken","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StealTokenDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/socksStop/{port}":{"post":{"tags":["Tunneling"],"summary":"Stop SOCKS Server","description":"Stop the specific SOCKS server and terminate existing connections.\n\nRelated CS Console Command: socks stop","operationId":"executeSocksStopByPort","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}},{"name":"port","in":"path","required":true,"schema":{"type":"integer","format":"int32"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/socksStop/all":{"post":{"tags":["Tunneling"],"summary":"Stop All SOCKS Servers","description":"Stop the SOCKS servers and terminate existing connections.\n\nRelated CS Console Command: socks stop","operationId":"executeSocksStopAll","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/socks5Start":{"post":{"tags":["Tunneling"],"summary":"Start SOCKS5 Server","description":"Starts a SOCKS5 server on the specified port.\n\nRelated CS Console Command: socks [port] socks5","operationId":"executeSocks5Start","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Socks5StartDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/socks4Start":{"post":{"tags":["Tunneling"],"summary":"Start SOCKS4a Server","description":"Starts a SOCKS4a server on the specified port.\n\nRelated CS Console Command: socks [port] socks4","operationId":"executeSocks4Start","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Socks4StartDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/setenv":{"post":{"tags":["ProcessAndExecution"],"summary":"Set Environment variable","description":"Set an environment variable.\n\nRelated CS Console Command: setenv","operationId":"executeSetEnv","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SetEnvDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/rportfwdStop/onTeamserver":{"post":{"tags":["Tunneling"],"summary":"Stop Reverse Port Forwarding","description":"Stop remote port forward on the specific port.\n\nRelated CS Console Command: rportfwd stop","operationId":"executeRemotePortForwardStopOnTeamserver","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RportFwdStopDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/rportfwdStart/onTeamserver":{"post":{"tags":["Tunneling"],"summary":"Start Remote Port Forwarding","description":"Binds the specified port on the target host. When a connection comes in, Cobalt Strike will make a connection to the forwarded host/port and use Beacon to relay traffic between the two connections.\n\nRelated CS Console Command: rportfwd","operationId":"executeRemotePortForwardStartOnTeamserver","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RportForwardBindDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/rm":{"post":{"tags":["FileAndRegistry"],"summary":"Remove File or Folder","description":"Remove a file or folder via the Beacon.\n\nRelated CS Console Command: rm","operationId":"executeRm","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RmDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/rev2self":{"post":{"tags":["CredsAndTokens"],"summary":"Revert Token","description":"Request a Beacon to drop any tokens and revert to the original access token.\n\nRelated CS Console Command: rev2self","operationId":"executeRev2Self","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/reg/queryv":{"post":{"tags":["FileAndRegistry"],"summary":"Get Registry SubKey","description":"Query a subkey within the registry. Lists only the subkey and its value.\n\nRelated CS Console Command: reg queryv","operationId":"executeRegQueryValue","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegQueryValueDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/reg/query":{"post":{"tags":["FileAndRegistry"],"summary":"Get Registry Key","description":"Query a key within the registry. Lists all subkeys and values.\n\nRelated CS Console Command: reg query","operationId":"executeRegQuery","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegQueryDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/pwd":{"post":{"tags":["FileAndRegistry"],"summary":"Get Current Directory","description":"Displays the current working directory of this Beacon.\n\nRelated CS Console Command: pwd","operationId":"executePwd","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/ps":{"post":{"tags":["ProcessAndExecution"],"summary":"List Process information","description":"List information about processes running on the system.\\n\\nRelated CS Console Command: ps","operationId":"executePs","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/powershell/import":{"post":{"tags":["ProcessAndExecution"],"summary":"Import Powershell Script","description":"Import a powershell script which is combined with future calls to the powershell command.","operationId":"executePowerShellImport","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PowerShellImportDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/net/domain":{"post":{"tags":["NetworkRecon"],"summary":"Get Domain","description":"Get active directory domain for current system.\n\nRelated CS Console Command: net domain","operationId":"executeNetDomain","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/mv":{"post":{"tags":["FileAndRegistry"],"summary":"Move File","description":"Move source file to the specified destination.\n\nRelated CS Console Command: mv","operationId":"executeMove","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MoveDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/mkdir":{"post":{"tags":["FileAndRegistry"],"summary":"Create Directory","description":"Create a directory, if it does not already exist.\n\nRelated CS Console Command: mkdir","operationId":"executeMkdir","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MkdirDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/makeToken/upn":{"post":{"tags":["CredsAndTokens"],"summary":"Make Token with UPN","description":"Ask Beacon to create a token from the specified credentials using UPN syntax.\n\nRelated CS Console Command: make_token","operationId":"executeMakeTokenUpn","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MakeTokenUpnDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/makeToken/logonName":{"post":{"tags":["CredsAndTokens"],"summary":"Make Token with Logon Name","description":"Ask Beacon to create a token from the specified credentials using domain, user and password.\n\nRelated CS Console Command: make_token","operationId":"executeMakeTokenLogonName","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MakeTokenLogonNameDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/ls":{"post":{"tags":["FileAndRegistry"],"summary":"List Directory contents","description":"Lists files in a folder.\n\nRelated CS Console Command: ls","operationId":"executeLs","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LsDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/link/tcp":{"post":{"tags":["Pivoting"],"summary":"Connect to TCP Beacon","description":"Connect to a TCP Beacon and re-establish control of it.\n\nRelated CS Console Command: connect","operationId":"executeLinkTcp","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConnectDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/link/smb":{"post":{"tags":["Pivoting"],"summary":"Connect to SMB Beacon","description":"Connect to an SMB Beacon and re-establish control of it.\n\nRelated CS Console Command: link","operationId":"executeLinkSmb","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LinkDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/killProcess":{"post":{"tags":["ProcessAndExecution"],"summary":"Kill Process","description":"Kills the specified process.\n\nRelated CS Console Command: kill","operationId":"executeKillProcess","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KillDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/kerberos/ticket/use":{"post":{"tags":["CredsAndTokens"],"summary":"Use Kerberos Ticket","description":"Applies a Kerberos ticket (.kirbi) to this session.\n\nRelated CS Console Command: kerberos_ticket_use","operationId":"executeKerberosTicketUse","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/KerberosTicketUseDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/kerberos/ticket/purge":{"post":{"tags":["CredsAndTokens"],"summary":"Purge Kerberos Ticket","description":"Purges Kerberos tickets from this session.\n\nRelated CS Console Command: kerberos_ticket_purge","operationId":"executeKerberosTicketPurge","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/jobStop":{"post":{"tags":["JobsAndTasks"],"summary":"Stop Job","description":"Stop a specific job.\n\nRelated CS Console Command: jobkill","operationId":"executeJobStop","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobKillDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/getUid":{"post":{"tags":["ProcessAndExecution"],"summary":"Get current User ID","description":"Get the User ID associated with the current token.","operationId":"executeGetUid","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/getSystem":{"post":{"tags":["ProcessAndExecution"],"summary":"Attempt to obtain System Privileges","description":"Elevate the session permissions from a local administrator to SYSTEM.\n\nRelated CS Console Command: getsystem","operationId":"executeGetSystem","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/getPrivs":{"post":{"tags":["ProcessAndExecution"],"summary":"Enable all available privileges","description":"Enable as many system privileges as possible on current token.\n\nRelated CS Console Command: getprivs","operationId":"executeGetPrivs","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/exit":{"post":{"tags":["ProcessAndExecution"],"summary":"Exit","description":"Terminate the Beacon session.\n\nRelated CS Console Command: exit","operationId":"executeExit","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/drives":{"post":{"tags":["FileAndRegistry"],"summary":"List Drives","description":"Lists drivers on current system.\n\nRelated CS Console Command: drives","operationId":"executeDrives","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/download":{"post":{"tags":["FileAndRegistry"],"summary":"Download File","description":"Download a file to the team server.\n\nRelated CS Console Command: download","operationId":"executeDownload","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DownloadDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/cp":{"post":{"tags":["FileAndRegistry"],"summary":"Copy File","description":"Copy source file to the specified destination.\n\nRelated CS Console Command: cp","operationId":"executeCp","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CpDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/clipboard":{"post":{"tags":["Capture"],"summary":"Get Clipboard content","description":"Get text from the clipboard contents.\n\nRelated CS Console Command: clipboard","operationId":"executeClipboard","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/checkIn":{"post":{"tags":["BeaconInfo"],"summary":"DNS Beacon Checkin","description":"Request DNS Beacon to send metadata to teamserver.\n\nRelated CS Console Command: checkin","operationId":"executeCheckIn","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/cd":{"post":{"tags":["FileAndRegistry"],"summary":"Change Current Directory","description":"Change the working directory of this Beacon.\n\nRelated CS Console Command: cd","operationId":"executeCd","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CdDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/cancelFileDownload":{"post":{"tags":["FileAndRegistry"],"summary":"Cancel Download","description":"Cancels a download that is currently in progress.\n\nRelated CS Console Command: cancel","operationId":"cancelFileDownload","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FileDownloadCancelDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/browserpivotStop":{"post":{"tags":["Tunneling"],"summary":"Stop Browser Pivot","description":"Tear down the browser pivoting sessions associated with this Beacon.\n\nRelated CS Console Command: browserpivot","operationId":"executeBrowserPivotStop","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/bof/string":{"post":{"tags":["ProcessAndExecution"],"summary":"Run BOF","description":"Execute a Beacon Object File (BOF) with a String argument.\n\nRelated CS Console Command: inline-execute","operationId":"executeBOFStringArg","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InlineExecuteStringDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/bof/packed":{"post":{"tags":["ProcessAndExecution"],"summary":"Run BOF with Packed Arguments","description":"Execute a Beacon Object File (BOF) with the packed argument.\n\nRelated CS Aggressor function: binline_execute()","operationId":"executeBOFPackedArg","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InlineExecutePackedDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/bof/pack":{"post":{"tags":["ProcessAndExecution"],"summary":"Pack Arguments and Run BOF","description":"Pack the provided arguments and execute a Beacon Object File (BOF) with the resulting packed argument.\n\nRelated CS Aggressor function: bof_pack() then binline_execute()","operationId":"executeBOFToPackArgs","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InlineExecutePackDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/execute/beaconInfo":{"post":{"tags":["BeaconConfig"],"summary":"Get Beacon Info","description":"Prints detailed information about the Beacon's runtime state such as its base address, allocated memory regions, allocated section details, heap records and sleep mask information.\nUseful for inspecting the current memory layout of Beacon.\n\nRelated CS Console Command: beacon_info","operationId":"executeBeaconInfo","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/elevate/command":{"get":{"tags":["ProcessAndExecution"],"summary":"List Command Privilege Elevators","description":"List available local privilege elevation techniques specific for running a command.\n\nRelated CS Console Command: runasadmin","operationId":"listElevateCommandMethods","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ElevatorInfoDto"}}}}}},"security":[{"BearerAuthentication":[]}]},"post":{"tags":["ProcessAndExecution"],"summary":"Run a Command elevated (runasadmin)","description":"Attempt to execute the command in an elevated context using the specified privilege elevation technique. Depending on technique, proceses could be spawned or injected.\n\nRelated CS Console Command: runasadmin","operationId":"elevateCommand","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RunAsAdminDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/elevate/beacon":{"get":{"tags":["CredsAndTokens"],"summary":"List Privesc methods","description":"List available local privilege elevation techniques specific for running a Beacon.\n\nRelated CS Console Command: elevate","operationId":"listElevateBeaconMethods","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/LocalExploitInfoDto"}}}}}},"security":[{"BearerAuthentication":[]}]},"post":{"tags":["CredsAndTokens"],"summary":"Run a Beacon elevated (elevate)","description":"Attempt to create an elevated Beacon session with the specified privilege elevation technique. Depending on technique, proceses could be spawned or injected.\n\nRelated CS Console Command: elevate","operationId":"elevateBeacon","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ElevateDto"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/consoleCommand":{"post":{"tags":["ConsoleCommand"],"summary":"Run Command","description":"Execute a console command on a Beacon. \n\nCan be used: \n - to run commands and syntax as if on the normal console;\n - to call server side aliases.","operationId":"executeConsoleCommand","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"requestBody":{"description":"Command to execute","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CommandDto"},"examples":{"Basic Command":{"description":"Basic Command","value":{"command":"ps"}},"Basic Command with arguments":{"description":"Basic Command with arguments","value":{"command":"ls","arguments":"path"}},"Command with arguments and @files symbolic reference to a base64 encoded string.":{"description":"Command with arguments and @files symbolic reference to a base64 encoded string.","value":{"command":"execute-assembly","arguments":"@files/Rubeus.exe logonsession","files":{"Rubeus.exe":"base64=="}}},"Command with arguments and @artifacts symbolic reference to an artifact stored on the teamserver.":{"description":"Command with arguments and @artifacts symbolic reference to an artifact stored on the teamserver.","value":{"command":"execute-assembly","arguments":"@artifacts/assemblies/Example.exe arg1 arg2"}}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/clearCommandQueue":{"post":{"tags":["BeaconInfo"],"summary":"Clear Queue","description":"Clear the Beacon queue of pending commands not yet distributed to the Beacon.\n\nRelated CS Console Command: clear","operationId":"clearCommandQueue","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/auth/login":{"post":{"tags":["Security"],"summary":"Generate a token to access the Rest API Server","operationId":"authenticateUser","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AuthDto"}}}}}}},"/api/v1":{"get":{"tags":["ServerConfig"],"summary":"Entry point to the API","description":"Entry point to the API","operationId":"apiRoot","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/tasks":{"get":{"tags":["JobsAndTasks"],"summary":"List Tasks","description":"Retrieve the summarized information / listing of all tasks.","operationId":"listTasks","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskSummaryDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/tasks/{taskId}":{"get":{"tags":["JobsAndTasks"],"summary":"Get Task","description":"Retrieve the detailed information for a specific task.","operationId":"getTaskById","parameters":[{"name":"taskId","in":"path","description":"ID of the task","required":true,"schema":{"type":"string"}},{"name":"format","in":"query","description":"Select the output format","required":false,"schema":{"type":"string","default":"structured","enum":["plain","structured"]}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/TaskDetailDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/payloads/{fileName}":{"get":{"tags":["PayloadAndArtifacts"],"summary":"Retrieve payload","description":"Retrieve a previously generated payload stored server-side.","operationId":"downloadPayload","parameters":[{"name":"fileName","in":"path","description":"Name of the payload to download","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string","format":"byte"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners":{"get":{"tags":["Listeners"],"summary":"List Listeners","description":"Lists all listeners.\n\nRelated CS Aggressor function: listeners_local()","operationId":"listListeners","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ListenerBaseDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/listeners/{name}":{"get":{"tags":["Listeners"],"summary":"Get Listener","description":"Get the information of a specific listener.\n\nRelated CS Aggressor function: listener_info()","operationId":"getListenerByName","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"object"}}}}},"security":[{"BearerAuthentication":[]}]},"delete":{"tags":["Listeners"],"summary":"Delete Listener","description":"Delete a Listener.\n\nRelated CS Aggressor function: listener_delete()","operationId":"deleteListener","parameters":[{"name":"name","in":"path","description":"Name of the listener","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/data/screenshots":{"get":{"tags":["Capture"],"summary":"List Screenshots","description":"Returns a list of screenshots from Cobalt Strike's data model.\n\nRelated CS Aggressor function: screenshots()","operationId":"listScreenshots","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ScreenshotDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/data/screenshots/{id}":{"get":{"tags":["Capture"],"summary":"Get Screenshot","description":"Retrieve a specified Screenshot from Cobalt Strike's data model.","operationId":"getScreenshot","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/StreamingResponseBody"}}}}},"security":[{"BearerAuthentication":[]}]},"delete":{"tags":["Capture"],"summary":"Delete Screenshot","description":"Delete the specified Screenshot from Cobalt Strike's data model.","operationId":"deleteScreenshot","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/data/keystrokes":{"get":{"tags":["Capture"],"summary":"List Keystrokes","description":"List all keystrokes in the inventory.","operationId":"listKeyStrokes","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/KeystrokeDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/data/downloads":{"get":{"tags":["FileAndRegistry"],"summary":"List Downloads","description":"Lists all downloaded files from the Downloads data model.\n\nRelated CS Aggressor function: downloads()","operationId":"listDownloads","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DownloadDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/data/downloads/{id}":{"get":{"tags":["FileAndRegistry"],"summary":"Get Download","description":"Get the specified download from the team servers Downloads data model.","operationId":"getDownload","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/StreamingResponseBody"}}}}},"security":[{"BearerAuthentication":[]}]},"delete":{"tags":["FileAndRegistry"],"summary":"Delete Download","description":"Delete a Download from the Downloads data model.","operationId":"deleteDownload","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/data/credentials/{id}":{"get":{"tags":["CredsAndTokens"],"summary":"Get Credential","description":"Get the information of the specified credential from the credentials data model.","operationId":"getCredential","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CredentialDto"}}}}},"security":[{"BearerAuthentication":[]}]},"delete":{"tags":["CredsAndTokens"],"summary":"Delete Credential","description":"Delete a credential from the credentials data model.","operationId":"deleteCredential","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"OK"}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/config/teamserverIp":{"get":{"tags":["ServerConfig"],"summary":"Get team server IP","description":"Retrieve the IP address associated with the team server.","operationId":"getTeamserverIp","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/config/systeminformation":{"get":{"tags":["ServerConfig"],"summary":"Get System Information","description":"Get information about your Cobalt Strike configuration. This information can help in troubleshooting or support requests.","operationId":"getSystemInformation","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/config/profile":{"get":{"tags":["ServerConfig"],"summary":"Get Malleable Profile","description":"Retrieve the Malleable C2 profile.","operationId":"getC2Profile","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/config/killdate":{"get":{"tags":["ServerConfig"],"summary":"Get the Beacon kill date configured on the team server","description":"Get the Beacon kill date configured on the team server.","operationId":"getKillDate","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons":{"get":{"tags":["BeaconInfo"],"summary":"List Beacons","description":"Return a list containing metadata about each Beacon such as ID, Process, computer, listener, etc.\n\nRelated CS Aggressor function: beacons()","operationId":"listBeacons","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BeaconDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}":{"get":{"tags":["BeaconInfo"],"summary":"Get Beacons","description":"Get metadata of the specified Beacon Id.\n\nRelated CS Aggressor function: beacon_info()","operationId":"getBeacon","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/BeaconDto"}}}}},"security":[{"BearerAuthentication":[]}]},"delete":{"tags":["BeaconInfo"],"summary":"Delete Beacon","description":"Remove a Beacon session from the Beacon listing/GUI and Beacons data model.\n\nNote: Prior to removing, active Beacons should be terminated with the \"\"exit\"\" command or {bid}/execute/exit route or they will re-appear once they check-in.\n\nRelated CS Aggressor function: beacon_remove()","operationId":"deleteBeacon","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/tasks/summary":{"get":{"tags":["JobsAndTasks"],"summary":"Get Beacon Tasks Summary","description":"Retrieve the summarized information / listing of all tasks for a specific Beacon.","operationId":"listTaskSummariesByBid","parameters":[{"name":"bid","in":"path","description":"Beacon ID","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskSummaryDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/tasks/detail":{"get":{"tags":["JobsAndTasks"],"summary":"List Beacon Tasks","description":"Retrieve the detailed information for Beacon's tasks.","operationId":"listTasksByBid","parameters":[{"name":"bid","in":"path","description":"Beacon ID","required":true,"schema":{"type":"string"}},{"name":"format","in":"query","description":"Select the output format","required":false,"schema":{"type":"string","default":"structured","enum":["plain","structured"]}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskDetailDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/c2/host/profiles":{"get":{"tags":["BeaconConfig"],"summary":"List Host Profiles","description":"List the host profiles defined in the Beacon from Malleable C2 definition.\n\nRelated CS Console Command: beacon_config profiles","operationId":"listHostProfiles","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/state/c2/failoverNotification":{"get":{"tags":["BeaconConfig"],"summary":"Get Failover Notification config","description":"Get the current failover notification setting from a Beacon [HTTP|DNS].\n\nRelated CS Console Command: beacon_config failover_notification","operationId":"getCurrentFailoverNotificationSetting","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/AsyncCommandResponse"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/keystrokes":{"get":{"tags":["Capture"],"summary":"List Beacon Keystrokes","description":"List all keystrokes for a specified Beacon.","operationId":"getKeyStrokesByBid","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/KeystrokeDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/help":{"get":{"tags":["ConsoleCommand"],"summary":"Help","description":"List help for all commands available on the consoleCommand route (including possible server side aliases).\n\nRelated CS Console Command: help","operationId":"listCommandHelp","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CommandHelpInfoDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/help/{command}":{"get":{"tags":["ConsoleCommand"],"summary":"Command Help","description":"Get the help of a specific command that is available as a consoleCommand.\n\nRelated CS Console Command: help","operationId":"getCommandHelp","parameters":[{"name":"bid","in":"path","description":"Beacon id","required":true,"schema":{"type":"string"}},{"name":"command","in":"path","description":"Command name","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/CommandHelpInfoDto"}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/beacons/{bid}/activeDownloads":{"get":{"tags":["FileAndRegistry"],"summary":"List Active Downloads","description":"Lists file downloads currently in progress for a given Beacon.\n\nRelated CS Console Command: downloads","operationId":"listActiveDownloads","parameters":[{"name":"bid","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DownloadProgressDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/artifacts":{"get":{"tags":["PayloadAndArtifacts"],"summary":"List Artifacts","description":"Retrieve a listing of all server side artifacts/files and their references. Various commands that expect a filename can ingest an artifact (e.g. executeBOF).","operationId":"listArtifacts","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ArtifactDto"}}}}}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/data/keystrokes/{id}":{"delete":{"tags":["Capture"],"summary":"Delete Keystrokes","description":"Delete a specified Keystroke.","operationId":"deleteKeystrokes","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK"}},"security":[{"BearerAuthentication":[]}]}},"/api/v1/config/resetData":{"delete":{"tags":["ServerConfig"],"summary":"Reset Data Model","description":"Reset Cobalt Strike's data model. Use with care as all the inventory will be reset (Listeners, Credentials, Keys, Downloads, etc.).","operationId":"resetData","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"string"}}}}},"security":[{"BearerAuthentication":[]}]}}},"components":{"schemas":{"GuardRailsDto":{"type":"object","description":"The guard rails settings","properties":{"ipAddress":{"type":"string","description":"Enter a specific IP Address, generic wildcard (\\*) of the right most segments, or empty string","example":"123.123.*.*","pattern":"^$|^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(\\*|25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(\\*|25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(\\*|25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)$"},"userName":{"type":"string","description":"Enter a specific user name. Valid formats: starts with '\\*', ends with '\\*', or empty string","example":"admin*","pattern":"^$|^(?!\\*.*\\*$)(?!.*\\s).+$"},"serverName":{"type":"string","description":"Enter a specific server name. Valid formats: starts with '\\*', ends with '\\*', or empty string","example":"foo*","pattern":"^$|^(?!\\*.*\\*$)(?!.*\\s).+$"},"domain":{"type":"string","description":"Enter a specific domain name. Valid formats: starts with '\\*', ends with '\\*', or empty string","example":"*bar.com","pattern":"^$|^(?!\\*.*\\*$)(?!.*\\s).+$"}}},"UserDefinedC2ListenerDto":{"type":"object","properties":{"name":{"type":"string","description":"Name of the listener","example":"udc2","minLength":1},"color":{"type":"string","description":"Set the color that is used in the Cobalt Strike UI for the listner.","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"error":{"type":"string","description":"Error message indicating why the listener service failed","readOnly":true},"port":{"type":"integer","format":"int32","description":"Port (Bind)","example":3333,"maximum":65535,"minimum":1},"localHostOnly":{"type":"boolean","description":"Bind to localhost only","example":false},"debugOnly":{"type":"boolean","description":"Debug only","example":false},"udc2Bof":{"type":"string","description":"The file or artifact reference for a User Defined C2 bof","example":"@files/udc2.x64.o or @artifacts/userDefinedC2/icmp/udc2.x64.o","minLength":1},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the udc2Bof fields starts with '@files/'.","example":{"udc2.x64.o":"TVp..."}},"guardRails":{"$ref":"#/components/schemas/GuardRailsDto","description":"The guard rails settings to use for the listener"},"payload":{"type":"string","description":"Payload type","readOnly":true}},"required":["color","debugOnly","localHostOnly","name","port","udc2Bof"]},"TcpListenerDto":{"type":"object","properties":{"name":{"type":"string","description":"Name of the listener","example":"tcp","minLength":1},"color":{"type":"string","description":"Set the color that is used in the Cobalt Strike UI for the listner.","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"error":{"type":"string","description":"Error message indicating why the listener service failed","readOnly":true},"port":{"type":"integer","format":"int32","description":"Port (C2)","example":1234,"maximum":65535,"minimum":1},"localHostOnly":{"type":"boolean","description":"Bind to localhost only","example":false},"guardRails":{"$ref":"#/components/schemas/GuardRailsDto","description":"The guard rails settings to use for the listener"},"payload":{"type":"string","description":"Payload type","readOnly":true}},"required":["color","localHostOnly","name","port"]},"SmbListenerDto":{"type":"object","properties":{"name":{"type":"string","description":"Name of the listener","example":"smb","minLength":1},"color":{"type":"string","description":"Set the color that is used in the Cobalt Strike UI for the listner.","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"error":{"type":"string","description":"Error message indicating why the listener service failed","readOnly":true},"pipename":{"type":"string","description":"Pipename (C2):","example":"mypipe","maxLength":118,"minLength":1},"guardRails":{"$ref":"#/components/schemas/GuardRailsDto","description":"The guard rails settings to use for the listener"},"payload":{"type":"string","description":"Payload type","readOnly":true}},"required":["color","name","pipename"]},"HttpsListenerDto":{"type":"object","properties":{"name":{"type":"string","description":"Name of the listener","example":"https","minLength":1},"color":{"type":"string","description":"Set the color that is used in the Cobalt Strike UI for the listner.","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"error":{"type":"string","description":"Error message indicating why the listener service failed","readOnly":true},"hosts":{"type":"array","description":"HTTPS Hosts","example":["host1.example.com","host2.example.com"],"items":{"type":"string"},"minItems":1},"host":{"type":"string","description":"HTTPS Host (Stager)","example":"host1.example.com","minLength":1},"httpPort":{"type":"integer","format":"int32","description":"HTTPS Port (C2)","example":443,"maximum":65535,"minimum":1},"httpBindPort":{"type":"integer","format":"int32","description":"HTTPS Port (Bind)","example":null,"maximum":65535,"minimum":1},"httpHostHeader":{"type":"string","description":"HTTPS Host Header","example":null},"hostRotationStrategy":{"type":"string","description":"Host Rotation Strategy","example":"round-robin"},"maxRetryStrategy":{"type":"string","description":"Max Retry Strategy specified using the following format: exit-[max_attempts]-[increase_attempts]-[duration][m,h,d] or none","example":"exit-10-5-5m","pattern":"^none$|^exit-\\d+-\\d+-\\d+[m,h,d]$"},"profile":{"type":"string","description":"Profile variant name","example":"default"},"ignoreProxySettings":{"type":"boolean","description":"Set to true to use a direct connection. Set to false to use the http proxy settings.","example":false},"httpProxy":{"$ref":"#/components/schemas/ProxyDto","description":"Override the default behavior to use the Internet Explorer proxy configuration for the current process/user context by configuring the proxy settings."},"guardRails":{"$ref":"#/components/schemas/GuardRailsDto","description":"The guard rails settings to use for the listener"},"payload":{"type":"string","description":"Payload type","readOnly":true}},"required":["color","host","hosts","ignoreProxySettings","name"]},"ProxyDto":{"type":"object","properties":{"protocol":{"type":"string","description":"Proxy Type (http | socks)","enum":["http","socks"],"example":"http"},"host":{"type":"string","description":"Proxy Host","example":null},"port":{"type":"integer","format":"int32","description":"Proxy Port","example":null,"maximum":65535,"minimum":1},"userName":{"type":"string","description":"Username","example":null},"password":{"type":"string","description":"Password","example":null}},"required":["protocol"]},"HttpListenerDto":{"type":"object","properties":{"name":{"type":"string","description":"Name of the listener","example":"http","minLength":1},"color":{"type":"string","description":"Set the color that is used in the Cobalt Strike UI for the listner.","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"error":{"type":"string","description":"Error message indicating why the listener service failed","readOnly":true},"hosts":{"type":"array","description":"HTTP Hosts","example":["host1.example.com","host2.example.com"],"items":{"type":"string"},"minItems":1},"host":{"type":"string","description":"HTTP Host (Stager)","example":"host1.example.com","minLength":1},"httpPort":{"type":"integer","format":"int32","description":"HTTP Port (C2)","example":80,"maximum":65535,"minimum":1},"httpBindPort":{"type":"integer","format":"int32","description":"HTTP Port (Bind)","example":null,"maximum":65535,"minimum":1},"httpHostHeader":{"type":"string","description":"HTTP Host Header","example":null},"hostRotationStrategy":{"type":"string","description":"Host Rotation Strategy","example":"round-robin"},"maxRetryStrategy":{"type":"string","description":"Max Retry Strategy specified using the following format: exit-[max_attempts]-[increase_attempts]-[duration][m,h,d] or none","example":"exit-10-5-5m","pattern":"^none$|^exit-\\d+-\\d+-\\d+[m,h,d]$"},"profile":{"type":"string","description":"Profile variant name","example":"default"},"ignoreProxySettings":{"type":"boolean","description":"Set to true to use a direct connection. Set to false to use the http proxy settings.","example":false},"httpProxy":{"$ref":"#/components/schemas/ProxyDto","description":"Override the default behavior to use the Internet Explorer proxy configuration for the current process/user context by configuring the proxy settings."},"guardRails":{"$ref":"#/components/schemas/GuardRailsDto","description":"The guard rails settings to use for the listener"},"payload":{"type":"string","description":"Payload type","readOnly":true}},"required":["color","host","hosts","ignoreProxySettings","name"]},"ForeignHttpsListenerDto":{"type":"object","properties":{"name":{"type":"string","description":"Name of the listener","example":"foreign-https","minLength":1},"color":{"type":"string","description":"Set the color that is used in the Cobalt Strike UI for the listner.","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"error":{"type":"string","description":"Error message indicating why the listener service failed","readOnly":true},"host":{"type":"string","description":"HTTPS Host (Stager)","example":"host1.example.com","minLength":1},"port":{"type":"integer","format":"int32","description":"HTTPS Port (Stager)","example":443,"maximum":65535,"minimum":1},"payload":{"type":"string","description":"Payload type","readOnly":true}},"required":["color","host","name","port"]},"ForeignHttpListenerDto":{"type":"object","properties":{"name":{"type":"string","description":"Name of the listener","example":"foreign-http","minLength":1},"color":{"type":"string","description":"Set the color that is used in the Cobalt Strike UI for the listner.","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"error":{"type":"string","description":"Error message indicating why the listener service failed","readOnly":true},"host":{"type":"string","description":"HTTP Host (Stager)","example":"host1.example.com","minLength":1},"port":{"type":"integer","format":"int32","description":"HTTP Port (Stager)","example":80,"maximum":65535,"minimum":1},"payload":{"type":"string","description":"Payload type","readOnly":true}},"required":["color","host","name","port"]},"ExternalC2ListenerDto":{"type":"object","properties":{"name":{"type":"string","description":"Name of the listener","example":"extc2","minLength":1},"color":{"type":"string","description":"Set the color that is used in the Cobalt Strike UI for the listner.","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"error":{"type":"string","description":"Error message indicating why the listener service failed","readOnly":true},"port":{"type":"integer","format":"int32","description":"Port (Bind)","example":2222,"maximum":65535,"minimum":1},"localHostOnly":{"type":"boolean","description":"Bind to localhost only","example":false},"payload":{"type":"string","description":"Payload type","readOnly":true}},"required":["color","localHostOnly","name","port"]},"DnsListenerDto":{"type":"object","properties":{"name":{"type":"string","description":"Name of the listener","example":"dns","minLength":1},"color":{"type":"string","description":"Set the color that is used in the Cobalt Strike UI for the listner.","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"error":{"type":"string","description":"Error message indicating why the listener service failed","readOnly":true},"hosts":{"type":"array","description":"DNS Hosts","example":["host1.example.com","host2.example.com"],"items":{"type":"string"},"minItems":1},"host":{"type":"string","description":"DNS Host (Stager)","example":"host1.example.com","minLength":1},"dnsBindPort":{"type":"integer","format":"int32","description":"DNS Port (Bind)","example":null,"maximum":65535,"minimum":1},"hostRotationStrategy":{"type":"string","description":"Host Rotation Strategy","example":"round-robin"},"maxRetryStrategy":{"type":"string","description":"Max Retry Strategy specified using the following format: exit-[max_attempts]-[increase_attempts]-[duration][m,h,d] or none","example":"exit-10-5-5m","pattern":"^none$|^exit-\\d+-\\d+-\\d+[m,h,d]$"},"profile":{"type":"string","description":"Profile variant name","example":"default"},"dnsResolver":{"type":"string","description":"DNS Resolver","example":null},"guardRails":{"$ref":"#/components/schemas/GuardRailsDto","description":"The guard rails settings to use for the listener"},"dnsPort":{"type":"integer","format":"int32","description":"DNS Port","readOnly":true},"payload":{"type":"string","description":"Payload type","readOnly":true}},"required":["color","host","hosts","name"]},"HostCallbackUpdateDto":{"type":"object","properties":{"infos":{"type":"array","items":{"$ref":"#/components/schemas/HostCallbackUpdateInfoDto"},"minItems":1}},"required":["infos"]},"HostCallbackUpdateInfoDto":{"type":"object","properties":{"fromHost":{"type":"string","minLength":1},"toHost":{"type":"string","minLength":1},"toUri":{"type":"string"}},"required":["fromHost","toHost"]},"AsyncCommandResponse":{"type":"object","properties":{"name":{"type":"string"},"status":{"type":"string"},"message":{"type":"string"},"statusUrl":{"type":"string"},"taskId":{"type":"string"}},"required":["message","name","status"]},"PublishOutputDto":{"type":"object","properties":{"message":{"type":"string","description":"The text to post"}},"required":["message"]},"PayloadStagerDto":{"type":"object","properties":{"listenerName":{"type":"string","description":"The listener name","example":"http","minLength":1},"architecture":{"type":"string","description":"The architecture of the payload (x86|x64)","enum":["x86","x64"],"example":"x64"},"output":{"type":"string","description":"The output format to use when the payload is saved.","enum":["C","C#","COM Scriptlet","Java","Perl","PowerShell","PowerShell Command","Python","Raw","Ruby","VBA","Veil"],"example":"Raw"},"payloadFileName":{"type":"string","description":"The name the payload file will be saved to in the artifacts/generated location.  A name will automatically be generated when it is not set.","example":"payload_x64.bin","pattern":"^[a-zA-Z0-9._-]+$"}},"required":["architecture","listenerName","output"]},"HashesDto":{"type":"object","properties":{"md5":{"type":"string","description":"The md5 hash"},"sha1":{"type":"string","description":"The sha1 hash"},"sha256":{"type":"string","description":"The sha256 hash"}}},"PayloadStagerResultDto":{"type":"object","properties":{"status":{"type":"string","description":"The status of the payload generation.","enum":["SUCCESS","FILE_ALREADY_EXISTS_ERROR","FILE_WRITE_ERROR","INVALID_PAYLOAD_PATH","IO_EXCEPTION_ERROR","PAYLOAD_GENERATION_ERROR"],"example":"SUCCESS"},"notes":{"type":"string","description":"Notes on the payload generation."},"informationFileName":{"type":"string","description":"The informational file containing payload details."},"payloadFileName":{"type":"string","description":"The generated payload file name."},"size":{"type":"integer","format":"int32","description":"The size of the payload in bytes."},"created":{"type":"string","format":"date-time","description":"The time when the payload was generated."},"hashes":{"$ref":"#/components/schemas/HashesDto","description":"The hashes for the generated payload."},"inputs":{"$ref":"#/components/schemas/PayloadStagerDto","description":"The information used to generate the payload."}}},"PayloadDto":{"type":"object","description":"Options for generating a stageless Payload","properties":{"listenerName":{"type":"string","description":"The listener name","example":"http","minLength":1},"useListenerGuardRails":{"type":"boolean","description":"A flag to use the listener's guard rails (true) or the guard rails defined here (false)","example":true},"guardRails":{"$ref":"#/components/schemas/GuardRailsDto","description":"The guard rails settings to use for the payload. The useListenerGuardRails must be set to 'false'"},"architecture":{"type":"string","description":"The architecture of the payload (x86|x64)","enum":["x86","x64"],"example":"x64"},"exitFunction":{"type":"string","description":"The method/behavior that Beacon uses when the exit command is executed.\nUse Process to to terminate the whole process or Thread to terminate the current thread.\n","enum":["Process","Thread"],"example":"Process"},"systemCallMethod":{"type":"string","description":"The system call method that Beacon uses when executing supported functions.","enum":["None","Direct","Indirect"],"example":"None"},"httpLibrary":{"type":"string","description":"The Microsoft library (WinINet or WinHTTP) to use for HTTP(S) beacons.","enum":["winhttp","wininet",""],"example":"wininet"},"dnsCommMode":{"type":"string","description":"The DNS comm mode (dns or dns-over-https) to use for DNS beacons.","enum":["dns","dns-over-https",""],"example":"dns"},"output":{"type":"string","description":"The output format to use when the payload is saved.","enum":["C","C#","Java","Perl","Python","Raw","Ruby","VBA"],"example":"Raw"},"payloadFileName":{"type":"string","description":"The name the payload file will be saved to in the artifacts/generated location.  A name will automatically be generated when it is not set.","example":"payload_x64.bin","pattern":"^[a-zA-Z0-9._-]*$"},"sleepMaskCNA":{"type":"string","description":"The sleep mask override script to use when generating the payload.","example":"@artifacts/sleepmasks/sleepmask-vs/sleepmask.cna","pattern":"^$|^(?:@artifacts/[A-Za-z0-9._:/-]+)$"},"udrlCNA":{"type":"string","description":"The udrl override script to use when generating the payload.","example":"@artifacts/udrls/udrl-vs/udrl-vs.cna","pattern":"^$|^(?:@artifacts/[A-Za-z0-9._:/-]+)$"},"options":{"type":"object","additionalProperties":{"type":"string"},"description":"A user defined options map to pass to the hooks when generating the payload.","example":{"sleepmask":"Default (SLEEPMASK-VS)","beacon_loader":"Default (UDRL-VS)"}}},"required":["architecture","exitFunction","listenerName","output","systemCallMethod","useListenerGuardRails"]},"PayloadResultDto":{"type":"object","properties":{"status":{"type":"string","description":"The status of the payload generation.","enum":["SUCCESS","FILE_ALREADY_EXISTS_ERROR","FILE_WRITE_ERROR","INVALID_PAYLOAD_PATH","IO_EXCEPTION_ERROR","PAYLOAD_GENERATION_ERROR"],"example":"SUCCESS"},"notes":{"type":"string","description":"Notes on the payload generation."},"informationFileName":{"type":"string","description":"The informational file containing payload details."},"payloadFileName":{"type":"string","description":"The generated payload file name."},"size":{"type":"integer","format":"int32","description":"The size of the payload in bytes."},"created":{"type":"string","format":"date-time","description":"The time when the payload was generated."},"hashes":{"$ref":"#/components/schemas/HashesDto","description":"The hashes for the generated payload."},"inputs":{"$ref":"#/components/schemas/PayloadDto","description":"The information used to generate the payload."}}},"CredentialDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid","readOnly":true},"user":{"type":"string"},"password":{"type":"string"},"realm":{"type":"string"},"note":{"type":"string"},"host":{"type":"string"},"source":{"type":"string"},"created":{"type":"string","format":"date-time","readOnly":true}},"required":["id","password","realm","user"]},"SyscallMethodDto":{"type":"object","properties":{"method":{"type":"string","minLength":1}},"required":["method"]},"SpoofedArgumentsAddDto":{"type":"object","properties":{"command":{"type":"string","minLength":1},"fakeArguments":{"type":"string","minLength":1}},"required":["command","fakeArguments"]},"SpawnToDto":{"type":"object","properties":{"arch":{"type":"string","enum":["x86","x64"],"example":"x64"},"path":{"type":"string","example":"%windir%\\sysnative\\rundll32.exe","minLength":1}},"required":["arch","path"]},"SleepDto":{"type":"object","properties":{"sleep":{"type":"integer","format":"int32","description":"The amount of time in seconds between beacon check-ins.","example":60,"minimum":0},"jitter":{"type":"integer","format":"int32","description":"The amount of jitter to apply to the sleep time to randomly change the time between check-ins.","example":80,"maximum":99,"minimum":0}},"required":["sleep"]},"PpidDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0}},"required":["pid"]},"DnsModeDto":{"type":"object","properties":{"mode":{"type":"string","enum":["dns","dns6","dnsTxt"]}},"required":["mode"]},"HostCallbackAddDto":{"type":"object","properties":{"infos":{"type":"array","items":{"$ref":"#/components/schemas/HostCallbackInfoDto"},"minItems":1}},"required":["infos"]},"HostCallbackInfoDto":{"type":"object","properties":{"hostname":{"type":"string","minLength":1},"uri":{"type":"string","minLength":1}},"required":["hostname","uri"]},"HostCallbackResetDto":{"type":"object","properties":{"action":{"type":"string","enum":["all","status","statistics"]},"hostnames":{"type":"array","items":{"type":"string"}}},"required":["action"]},"HostCallbackReleaseDto":{"type":"object","properties":{"hostnames":{"type":"array","items":{"type":"string"},"minItems":1}},"required":["hostnames"]},"HostCallbackHoldDto":{"type":"object","properties":{"hostnames":{"type":"array","items":{"type":"string"},"minItems":1}},"required":["hostnames"]},"SshSpawnDto":{"type":"object","properties":{"target":{"type":"string","minLength":1},"port":{"type":"integer","format":"int32","maximum":65535,"minimum":1},"username":{"type":"string","minLength":1},"password":{"type":"string","minLength":1}},"required":["password","target","username"]},"SshKeySpawnDto":{"type":"object","properties":{"target":{"type":"string","minLength":1},"port":{"type":"integer","format":"int32","maximum":65535,"minimum":1},"username":{"type":"string","minLength":1},"key":{"type":"string","minLength":1},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the key fields starts with '@files/'.","example":{"key.pem":"ZIYHAAA..."}}},"required":["key","target","username"]},"ShSpawnDto":{"type":"object","properties":{"arch":{"type":"string","enum":["x86","x64"]},"shellcode":{"type":"string","example":"@files/my.bin or @artifacts/shellCode/my.bin","minLength":1},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the shellcode fields starts with '@files/'.","example":{"my.bin":"ZIYHAAA..."}}},"required":["arch","shellcode"]},"PthSpawnDto":{"type":"object","properties":{"domain":{"type":"string"},"user":{"type":"string","minLength":1},"ntlmHash":{"type":"string","description":"The NTLM hash in hex format","example":"2049B70EC5B6944AED5FEF05BC4B1933","minLength":1,"pattern":"^(?:[0-9a-fA-F]{32}|[0-9a-fA-F]{32}:[0-9a-fA-F]{32})$"}},"required":["ntlmHash","user"]},"PowerShellDto":{"type":"object","properties":{"commandlet":{"type":"string","minLength":1},"arguments":{"type":"string"}},"required":["commandlet"]},"PatchDto":{"type":"object","properties":{"library":{"type":"string","example":"ntdll.dll","maxLength":260,"minLength":0,"pattern":"^[^,]*$"},"function":{"type":"string","example":"EtwEventWrite","maxLength":256,"minLength":0,"pattern":"^[^,]*$"},"offset":{"type":"integer","format":"int32","description":"The offset form the start of the executable function","example":0,"maximum":65535,"minimum":0},"patch":{"type":"string","description":"The patch value as a hex string of 2200 characters (must be pairs of 09, AF)","example":"C300","minLength":1,"pattern":"^([0-9A-F]{2}){1,100}$"}},"required":["function","library","offset","patch"]},"PowerPickDto":{"type":"object","properties":{"commandlet":{"type":"string","minLength":1},"arguments":{"type":"string"},"patches":{"type":"array","items":{"$ref":"#/components/schemas/PatchDto"}}},"required":["commandlet"]},"ExecuteDllDto":{"type":"object","properties":{"dll":{"type":"string","minLength":1},"arguments":{"type":"string"},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the dll fields starts with '@files/'.","example":{"postex.dll":"ZIYHAAA..."}}},"required":["dll"]},"PortScanSpawnDto":{"type":"object","properties":{"targets":{"type":"array","description":"List of hosts to scan. You may also specify IPv4 address ranges (e.g., 192.168.1.128-192.168.2.240, 192.168.1.0/24)","example":["127.0.0.1"],"items":{"type":"string"},"minItems":1},"ports":{"type":"array","description":"List of ports to scan. You may specify port ranges as well (e.g., 1-65536","example":["445"],"items":{"type":"string"},"minItems":1},"method":{"type":"string","description":"Dictate how the port scanning tool will determine if a host is alive","enum":["arp","icmp","none"],"example":"arp"},"maxConnections":{"type":"integer","format":"int32","description":"limits how many connections the port scan tool will attempt at any one time","example":1024,"minimum":1}},"required":["maxConnections","method","ports","targets"]},"NetViewDto":{"type":"object","properties":{"domain":{"type":"string","writeOnly":true}}},"NetUserDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true}}},"NetUserDetailDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"user":{"type":"string","writeOnly":true}}},"NetTimeDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true}}},"NetShareDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true}}},"NetSessionsDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true}}},"NetLogonsDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true}}},"NetLocalGroupDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"groupName":{"type":"string","writeOnly":true}}},"NetGroupDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"groupName":{"type":"string","writeOnly":true}}},"NetDomainTrustsDto":{"type":"object","properties":{"domain":{"type":"string","writeOnly":true}}},"NetDomainControllersDto":{"type":"object","properties":{"domain":{"type":"string","writeOnly":true}}},"NetDcListDto":{"type":"object","properties":{"domain":{"type":"string","writeOnly":true}}},"NetComputersDto":{"type":"object","properties":{"domain":{"type":"string","writeOnly":true}}},"MimikatzSpawnDto":{"type":"object","properties":{"command":{"type":"string","maxLength":511,"minLength":0},"mode":{"type":"string","enum":["normal","elevate","impersonate"]}},"required":["command","mode"]},"ExecuteAssemblyDto":{"type":"object","properties":{"assembly":{"type":"string","description":"The file reference for the .NET Assembly","example":"@artifacts/assemblies/GhostPack/Rubeus.exe","minLength":1},"arguments":{"type":"string"},"patches":{"type":"array","items":{"$ref":"#/components/schemas/PatchDto"}},"files":{"type":"object","additionalProperties":{"type":"string"}}},"required":["assembly"]},"DcSyncSpawnDto":{"type":"object","properties":{"domain":{"type":"string","minLength":1},"user":{"type":"string"}},"required":["domain"]},"ShellDto":{"type":"object","properties":{"command":{"type":"string","minLength":1}},"required":["command"]},"RunDto":{"type":"object","properties":{"program":{"type":"string","minLength":1},"arguments":{"type":"string"}},"required":["program"]},"RunUDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"command":{"type":"string","minLength":1},"arguments":{"type":"string"}},"required":["command","pid"]},"ExecuteDto":{"type":"object","properties":{"cmd":{"type":"string","minLength":1}},"required":["cmd"]},"RunAsDto":{"type":"object","properties":{"domain":{"type":"string"},"user":{"type":"string","minLength":1},"password":{"type":"string","minLength":1},"command":{"type":"string","minLength":1},"arguments":{"type":"string"}},"required":["command","password","user"]},"SpawnDto":{"type":"object","properties":{"listener":{"type":"string","minLength":1},"arch":{"type":"string","enum":["x86","x64"]}},"required":["listener"]},"SpawnuDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","description":"The PID of the parent process","minimum":0},"listener":{"type":"string","minLength":1}},"required":["listener","pid"]},"SpawnBeaconAsDto":{"type":"object","properties":{"domain":{"type":"string"},"user":{"type":"string"},"password":{"type":"string"},"listener":{"type":"string","minLength":1}},"required":["listener","password","user"]},"RemoteExecDto":{"type":"object","properties":{"method":{"type":"string","minLength":1},"target":{"type":"string","minLength":1},"command":{"type":"string","minLength":1}},"required":["command","method","target"]},"JumpDto":{"type":"object","properties":{"exploit":{"type":"string","minLength":1},"target":{"type":"string","minLength":1},"listener":{"type":"string","minLength":1}},"required":["exploit","listener","target"]},"NoteDto":{"type":"object","properties":{"note":{"type":"string"}},"required":["note"]},"SshInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]},"target":{"type":"string","minLength":1},"port":{"type":"integer","format":"int32","maximum":65535,"minimum":1},"username":{"type":"string","minLength":1},"password":{"type":"string","minLength":1}},"required":["arch","password","pid","target","username"]},"SshKeyInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]},"target":{"type":"string","minLength":1},"port":{"type":"integer","format":"int32","maximum":65535,"minimum":1},"username":{"type":"string","minLength":1},"key":{"type":"string","minLength":1},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the key fields starts with '@files/'.","example":{"key.pem":"ZIYHAAA..."}}},"required":["arch","key","pid","target","username"]},"ShInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]},"shellcode":{"type":"string","example":"@files/my.bin or @artifacts/shellCode/my.bin","minLength":1},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the shellcode fields starts with '@files/'.","example":{"my.bin":"ZIYHAAA..."}}},"required":["arch","pid","shellcode"]},"ScreenwatchInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]}},"required":["arch","pid"]},"ScreenshotInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]}},"required":["arch","pid"]},"PthInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]},"domain":{"type":"string"},"user":{"type":"string","minLength":1},"ntlmHash":{"type":"string","description":"The NTLM hash in hex format","example":"2049B70EC5B6944AED5FEF05BC4B1933","minLength":1,"pattern":"^(?:[0-9a-fA-F]{32}|[0-9a-fA-F]{32}:[0-9a-fA-F]{32})$"}},"required":["arch","ntlmHash","pid","user"]},"PrintScreenInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]}},"required":["arch","pid"]},"PowerShellInject":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]},"commandlet":{"type":"string","minLength":1},"arguments":{"type":"string"}},"required":["arch","commandlet","pid"]},"ExecuteDllInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"dll":{"type":"string","minLength":1},"arguments":{"type":"string"},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the dll fields starts with '@files/'.","example":{"postex.dll":"ZIYHAAA..."}}},"required":["dll","pid"]},"PortScanInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]},"targets":{"type":"array","description":"List of hosts to scan. You may also specify IPv4 address ranges (e.g., 192.168.1.128-192.168.2.240, 192.168.1.0/24)","example":["127.0.0.1"],"items":{"type":"string"},"minItems":1},"ports":{"type":"array","description":"List of ports to scan. You may specify port ranges as well (e.g., 1-65536","example":["445"],"items":{"type":"string"},"minItems":1},"method":{"type":"string","description":"Dictate how the port scanning tool will determine if a host is alive","enum":["arp","icmp","none"],"example":"arp"},"maxConnections":{"type":"integer","format":"int32","description":"limits how many connections the port scan tool will attempt at any one time","example":1024,"minimum":1}},"required":["arch","maxConnections","method","pid","ports","targets"]},"NetViewInjectDto":{"type":"object","properties":{"domain":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetUserInjectDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetUserDetailInjectDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"user":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetTimeInjectDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetShareInjectDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetSessionsInjectDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetLogonsInjectDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetLocalGroupInjectDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"groupName":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetGroupInjectDto":{"type":"object","properties":{"target":{"type":"string","writeOnly":true},"groupName":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetDomainTrustsInjectDto":{"type":"object","properties":{"domain":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetDomainControllersInjectDto":{"type":"object","properties":{"domain":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetDcListInjectDto":{"type":"object","properties":{"domain":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"NetComputersInjectDto":{"type":"object","properties":{"domain":{"type":"string","writeOnly":true},"pid":{"type":"integer","format":"int32","writeOnly":true},"arch":{"type":"string","enum":["x86","x64"],"writeOnly":true}}},"MimikatzInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]},"command":{"type":"string","maxLength":511,"minLength":0},"mode":{"type":"string","enum":["normal","elevate","impersonate"]}},"required":["arch","command","mode","pid"]},"LogonPasswordsInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]}},"required":["arch","pid"]},"DllLoadDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"path":{"type":"string","minLength":1}},"required":["path","pid"]},"KeyLoggerInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]}},"required":["arch","pid"]},"HashDumpInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]}},"required":["arch","pid"]},"DllInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"dll":{"type":"string","minLength":1},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the dll fields starts with '@files/'.","example":{"my.dll":"TVp..."}}},"required":["dll","pid"]},"DcSyncInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]},"domain":{"type":"string","minLength":1},"user":{"type":"string"}},"required":["arch","domain","pid"]},"ChromeDumpInjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]}},"required":["arch","pid"]},"BrowserPivotSetupDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","description":"To hijack authenticated web sessions, make sure the process is an Internet Explorer tab. These processes have iexplore.exe as their parent process.","minimum":0},"arch":{"type":"string","enum":["x86","x64"]}},"required":["arch","pid"]},"InjectDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"arch":{"type":"string","enum":["x86","x64"]},"listener":{"type":"string","minLength":1}},"required":["arch","listener","pid"]},"UploadDto":{"type":"object","properties":{"file":{"type":"string","example":"@files/my.bin or @artifacts/shellCode/my.bin","minLength":1},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the file field starts with '@files/'.","example":{"my.bin":"ZIYHAAA..."}}},"required":["file"]},"UnlinkDto":{"type":"object","properties":{"host":{"type":"string","minLength":1},"pid":{"type":"integer","format":"int32","minimum":0}},"required":["host"]},"TokenStoreUseDto":{"type":"object","properties":{"id":{"type":"integer","format":"int32","minimum":0}},"required":["id"]},"TokenStoreStealDto":{"allOf":[{"$ref":"#/components/schemas/OutputDto"},{"type":"object","properties":{"id":{"type":"integer","format":"int32","minimum":0},"pid":{"type":"integer","format":"int32","minimum":0},"user":{"type":"string"},"type":{"type":"string","default":"tokenStoreSteal","description":"Discriminator; fixed to 'tokenStoreSteal'.","enum":["tokenStoreSteal"]}}}],"required":["id","pid","timestamp","type","user"]},"TokenStoreStealAndUseDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"accessMask":{"type":"integer","format":"int32","minimum":0}},"required":["pid"]},"TokenStoreRemoveDto":{"type":"object","properties":{"ids":{"type":"array","items":{"type":"integer","format":"int32","minimum":0},"minItems":1}},"required":["ids"]},"TimeStompDto":{"type":"object","properties":{"source":{"type":"string","minLength":1},"destination":{"type":"string","minLength":1}},"required":["destination","source"]},"StealTokenDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0},"accessMask":{"type":"integer","format":"int32","minimum":0}},"required":["pid"]},"Socks5StartDto":{"type":"object","properties":{"port":{"type":"integer","format":"int32","maximum":65535,"minimum":1},"auth":{"$ref":"#/components/schemas/SocksAuthDto"},"enableLogging":{"type":"boolean"}},"required":["port"]},"SocksAuthDto":{"type":"object","properties":{"user":{"type":"string","maxLength":255,"minLength":0},"password":{"type":"string","maxLength":255,"minLength":0}},"required":["password","user"]},"Socks4StartDto":{"type":"object","properties":{"port":{"type":"integer","format":"int32","maximum":65535,"minimum":1}},"required":["port"]},"SetEnvDto":{"type":"object","properties":{"key":{"type":"string","minLength":1},"value":{"type":"string"}},"required":["key"]},"RportFwdStopDto":{"type":"object","properties":{"bindPort":{"type":"integer","format":"int32","maximum":65535,"minimum":1}},"required":["bindPort"]},"RportForwardBindDto":{"type":"object","properties":{"bindPort":{"type":"integer","format":"int32","maximum":65535,"minimum":1},"forwardHost":{"type":"string","minLength":1},"forwardPort":{"type":"integer","format":"int32","maximum":65535,"minimum":1}},"required":["bindPort","forwardHost","forwardPort"]},"RmDto":{"type":"object","properties":{"path":{"type":"string","minLength":1}},"required":["path"]},"RegQueryValueDto":{"type":"object","properties":{"arch":{"type":"string","enum":["x86","x64"]},"path":{"type":"string","minLength":1},"subkey":{"type":"string","minLength":1}},"required":["arch","path","subkey"]},"RegQueryDto":{"type":"object","properties":{"arch":{"type":"string","enum":["x86","x64"]},"path":{"type":"string","minLength":1}},"required":["arch","path"]},"PowerShellImportDto":{"type":"object","properties":{"script":{"type":"string","description":"The file or artifact reference for a powershell script","example":"@files/script.ps1","minLength":1},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the script fields starts with '@files/'.","example":{"script.ps1":"ZnVuY3Rpb24gU2F5LUhlbGxvV29ybGQgewogICAgV3JpdGUtT3V0cHV0ICJIZWxsbywgV29ybGQhIgp9Cg=="}}},"required":["script"]},"MoveDto":{"type":"object","properties":{"source":{"type":"string","minLength":1},"destination":{"type":"string","minLength":1}},"required":["destination","source"]},"MkdirDto":{"type":"object","properties":{"folder":{"type":"string","minLength":1}},"required":["folder"]},"MakeTokenUpnDto":{"type":"object","properties":{"upn":{"type":"string","format":"email","minLength":1},"password":{"type":"string","minLength":1}},"required":["password","upn"]},"MakeTokenLogonNameDto":{"type":"object","properties":{"domain":{"type":"string"},"user":{"type":"string","minLength":1},"password":{"type":"string","minLength":1}},"required":["password","user"]},"LsDto":{"type":"object","properties":{"path":{"type":"string","description":"A directory to list. Defaults to the current working directory if not provided."}}},"ConnectDto":{"type":"object","properties":{"target":{"type":"string","minLength":1},"port":{"type":"integer","format":"int32","maximum":65535,"minimum":1}},"required":["target"]},"LinkDto":{"type":"object","properties":{"target":{"type":"string","minLength":1},"pipe":{"type":"string"}},"required":["target"]},"KillDto":{"type":"object","properties":{"pid":{"type":"integer","format":"int32","minimum":0}},"required":["pid"]},"KerberosTicketUseDto":{"type":"object","properties":{"ticket":{"type":"string","example":"@files/file.ticket or @artifacts/kerberos/file.ticket","minLength":1},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the ticket fields starts with '@files/'.","example":{"file.ticket":"ZIYHAAA..."}}},"required":["ticket"]},"JobKillDto":{"type":"object","properties":{"jid":{"type":"integer","format":"int32","minimum":0}},"required":["jid"]},"DownloadDto":{"type":"object","properties":{"path":{"type":"string","minLength":1}},"required":["path"]},"CpDto":{"type":"object","properties":{"src":{"type":"string","description":"The source path","minLength":1},"dst":{"type":"string","description":"The destination path","minLength":1}},"required":["dst","src"]},"CdDto":{"type":"object","properties":{"path":{"type":"string","minLength":1}},"required":["path"]},"FileDownloadCancelDto":{"type":"object","properties":{"file":{"type":"string","description":"Filename to cancel. Wildcards are OK.","minLength":1}},"required":["file"]},"InlineExecuteStringDto":{"type":"object","properties":{"bof":{"type":"string","example":"@files/bof.o or @artifacts/BOFs/bof.o","minLength":1,"pattern":"^(?:@files/[A-Za-z0-9._-]+|@artifacts/[A-Za-z0-9._:/-]+)$"},"entrypoint":{"type":"string","example":"go"},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the bof fields starts with '@files/'.","example":{"bof.o":"ZIYHAAA..."}},"arguments":{"type":"string","example":"hello world"}},"required":["bof"]},"InlineExecutePackedDto":{"type":"object","properties":{"bof":{"type":"string","example":"@files/bof.o or @artifacts/BOFs/bof.o","minLength":1,"pattern":"^(?:@files/[A-Za-z0-9._-]+|@artifacts/[A-Za-z0-9._:/-]+)$"},"entrypoint":{"type":"string","example":"go"},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the bof fields starts with '@files/'.","example":{"bof.o":"ZIYHAAA..."}},"arguments":{"type":"string","example":"aGVsbG8="}},"required":["bof"]},"Arg":{"discriminator":{"propertyName":"type"},"properties":{"type":{"type":"string"}},"required":["type"]},"BinaryArg":{"allOf":[{"$ref":"#/components/schemas/Arg"}]},"InlineExecutePackDto":{"type":"object","properties":{"bof":{"type":"string","example":"@files/bof.o or @artifacts/BOFs/bof.o","minLength":1,"pattern":"^(?:@files/[A-Za-z0-9._-]+|@artifacts/[A-Za-z0-9._:/-]+)$"},"entrypoint":{"type":"string","example":"go"},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of fileKey -> base64 content. Required when the bof fields starts with '@files/'.","example":{"bof.o":"ZIYHAAA..."}},"arguments":{"type":"array","items":{"oneOf":[{"$ref":"#/components/schemas/BinaryArg"},{"$ref":"#/components/schemas/IntArg"},{"$ref":"#/components/schemas/ShortArg"},{"$ref":"#/components/schemas/StrArg"},{"$ref":"#/components/schemas/WideStrArg"}]},"writeOnly":true}},"required":["bof"]},"IntArg":{"allOf":[{"$ref":"#/components/schemas/Arg"}]},"ShortArg":{"allOf":[{"$ref":"#/components/schemas/Arg"}]},"StrArg":{"allOf":[{"$ref":"#/components/schemas/Arg"}]},"WideStrArg":{"allOf":[{"$ref":"#/components/schemas/Arg"}]},"RunAsAdminDto":{"type":"object","properties":{"exploit":{"type":"string","minLength":1},"command":{"type":"string","minLength":1},"arguments":{"type":"string"}},"required":["command","exploit"]},"ElevateDto":{"type":"object","properties":{"exploit":{"type":"string","minLength":1},"listener":{"type":"string","minLength":1}},"required":["exploit","listener"]},"CommandDto":{"type":"object","description":"Represents a command to execute.","properties":{"command":{"type":"string","description":"The command to execute.","minLength":1},"arguments":{"type":"string","description":"Command arguments string with symbolic reference"},"files":{"type":"object","additionalProperties":{"type":"string"},"description":"Map of files for the @files symbolic reference"}},"required":["command"]},"LoginRequest":{"type":"object","properties":{"username":{"type":"string","description":"User name","example":"morpheus","maxLength":64,"minLength":0,"pattern":"^[a-zA-Z0-9_.-]+$"},"password":{"type":"string","description":"Rest API Server Password (same as TeamServer)","example":"password","maxLength":512,"minLength":0},"duration_ms":{"type":"integer","format":"int64","description":"The duration a generated token is valid for (milliseconds)","example":86400000,"maximum":86400000,"minimum":0}},"required":["password","username"]},"AuthDto":{"type":"object","properties":{"access_token":{"type":"string"},"token_type":{"type":"string"},"expires_in":{"type":"integer","format":"int64","minimum":0}},"required":["access_token","token_type"]},"TaskSummaryDto":{"type":"object","properties":{"taskId":{"type":"string","minLength":1},"bid":{"type":"string","minLength":1},"jid":{"type":"integer","format":"int32"},"taskCommand":{"type":"string","minLength":1},"user":{"type":"string","minLength":1},"created":{"type":"string","format":"date-time","minLength":1},"updated":{"type":"string","format":"date-time"},"taskStatus":{"type":"string","enum":["NOT_FOUND","IN_PROGRESS","COMPLETED","FAILED","OUTPUT_RECEIVED"]}},"required":["bid","created","taskCommand","taskId","taskStatus","user"]},"ErrorMessageDto":{"type":"object","properties":{"message":{"type":"string"},"timestamp":{"type":"string","format":"date-time"}},"required":["message","timestamp"]},"FolderDto":{"allOf":[{"$ref":"#/components/schemas/OutputDto"},{"type":"object","properties":{"folder":{"type":"string"},"contents":{"type":"array","items":{"$ref":"#/components/schemas/FolderEntryDto"},"minItems":1},"type":{"type":"string","default":"ls","description":"Discriminator; fixed to 'ls'.","enum":["ls"]}}}],"required":["contents","folder","timestamp","type"]},"FolderEntryDto":{"type":"object","properties":{"name":{"type":"string"},"type":{"type":"string"},"modified":{"type":"string"},"size":{"type":"integer","format":"int64"}},"required":["modified","name","size","type"]},"JobInfoDto":{"type":"object","properties":{"jid":{"type":"integer","format":"int32"},"pid":{"type":"integer","format":"int32"},"description":{"type":"string"}},"required":["description","jid","pid"]},"JobsInfoDto":{"allOf":[{"$ref":"#/components/schemas/OutputDto"},{"type":"object","properties":{"jobs":{"type":"array","items":{"$ref":"#/components/schemas/JobInfoDto"}},"type":{"type":"string","default":"jobs","description":"Discriminator; fixed to 'jobs'.","enum":["jobs"]}}}],"required":["jobs","timestamp","type"]},"OutputDto":{"type":"object","discriminator":{"propertyName":"type"},"properties":{"timestamp":{"type":"string","format":"date-time"},"type":{"type":"string","enum":["text","ls","ps","jobs","tokenStore","tokenStoreSteal"]}},"required":["timestamp","type"]},"ProcessDto":{"type":"object","properties":{"process":{"type":"string"},"ppid":{"type":"integer","format":"int32"},"pid":{"type":"integer","format":"int32"},"arch":{"type":"string"},"user":{"type":"string"},"sessid":{"type":"string"}},"required":["pid","ppid","process"]},"ProcessListDto":{"allOf":[{"$ref":"#/components/schemas/OutputDto"},{"type":"object","properties":{"processList":{"type":"array","items":{"$ref":"#/components/schemas/ProcessDto"},"minItems":1},"type":{"type":"string","default":"ps","description":"Discriminator; fixed to 'ps'.","enum":["ps"]}}}],"required":["processList","timestamp","type"]},"TaskAckDto":{"type":"object","properties":{"text":{"type":"string"},"tactics":{"type":"array","items":{"type":"string"}},"timestamp":{"type":"string","format":"date-time"}},"required":["tactics","text","timestamp"]},"TaskDetailDto":{"type":"object","properties":{"taskId":{"type":"string","minLength":1},"bid":{"type":"string","minLength":1},"jid":{"type":"integer","format":"int32"},"taskCommand":{"type":"string","minLength":1},"user":{"type":"string","minLength":1},"created":{"type":"string","format":"date-time","minLength":1},"updated":{"type":"string","format":"date-time"},"taskStatus":{"type":"string","enum":["NOT_FOUND","IN_PROGRESS","COMPLETED","FAILED","OUTPUT_RECEIVED"]},"result":{"type":"array","items":{"oneOf":[{"$ref":"#/components/schemas/FolderDto"},{"$ref":"#/components/schemas/JobsInfoDto"},{"$ref":"#/components/schemas/ProcessListDto"},{"$ref":"#/components/schemas/TextOutputDto"},{"$ref":"#/components/schemas/TokenStoreDto"},{"$ref":"#/components/schemas/TokenStoreStealDto"}]}},"error":{"type":"array","items":{"$ref":"#/components/schemas/ErrorMessageDto"}},"tactics":{"type":"array","items":{"type":"string"},"uniqueItems":true},"taskAcknowledgements":{"type":"array","items":{"$ref":"#/components/schemas/TaskAckDto"}}},"required":["bid","created","error","result","tactics","taskAcknowledgements","taskCommand","taskId","taskStatus","user"]},"TextOutputDto":{"allOf":[{"$ref":"#/components/schemas/OutputDto"},{"type":"object","properties":{"output":{"type":"string"},"type":{"type":"string","default":"text","description":"Discriminator; fixed to 'text'.","enum":["text"]}}}],"required":["output","timestamp","type"]},"TokenDto":{"type":"object","properties":{"id":{"type":"integer","format":"int32","minimum":0},"user":{"type":"string"}},"required":["id","user"]},"TokenStoreDto":{"allOf":[{"$ref":"#/components/schemas/OutputDto"},{"type":"object","properties":{"tokens":{"type":"array","items":{"$ref":"#/components/schemas/TokenDto"},"minItems":1},"type":{"type":"string","default":"tokenStore","description":"Discriminator; fixed to 'tokenStore'.","enum":["tokenStore"]}}}],"required":["timestamp","tokens","type"]},"ListenerBaseDto":{"type":"object","properties":{"name":{"type":"string","minLength":1},"color":{"type":"string","description":"Set the color that is used in the Cobalt Strike UI for the listner.","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"error":{"type":"string","description":"Error message indicating why the listener service failed","readOnly":true},"payload":{"type":"string","description":"Payload type","readOnly":true}},"required":["color","name"]},"ScreenshotDto":{"type":"object","properties":{"id":{"type":"string"},"bid":{"type":"string"},"user":{"type":"string"},"computer":{"type":"string"},"timestamp":{"type":"integer","format":"int64"},"title":{"type":"string"}},"required":["bid","computer","id","timestamp","title","user"]},"StreamingResponseBody":{},"KeypressDto":{"type":"object","properties":{"title":{"type":"string"},"keypress":{"type":"string"}},"required":["keypress"]},"KeystrokeDto":{"type":"object","properties":{"id":{"type":"string","minLength":1},"bid":{"type":"string","minLength":1},"keystrokes":{"type":"array","items":{"$ref":"#/components/schemas/KeypressDto"},"minItems":1},"session":{"type":"integer","format":"int32"},"host":{"type":"string","minLength":1},"title":{"type":"string"},"user":{"type":"string"},"timestamp":{"type":"string","format":"date-time"}},"required":["bid","host","id","keystrokes","session","timestamp","title","user"]},"BeaconDto":{"type":"object","properties":{"bid":{"type":"string","description":"Beacon id which associates tasks and metadata to a session.","example":12345},"pbid":{"type":"string","description":"Beacon id of the parent Beacon that it is communicating through.","example":54321},"pid":{"type":"integer","format":"int32","description":"Process id that beacon is running under.","example":123},"process":{"type":"string","description":"Process name that beacon is running under.","example":"rundll32.exe"},"user":{"type":"string","description":"User name that beacon is running under.","example":"Administrator"},"impersonated":{"type":"string","description":"Impersonation information beacon is currently using."},"isAdmin":{"type":"boolean","description":"A flag indicating the beacon is running as an administrator.","example":true},"computer":{"type":"string","description":"Computer name where beacon is executing.","example":"TEST_SYS1"},"host":{"type":"string","description":"Host IP where beacon is executing.","example":"123.22.11.200"},"internal":{"type":"string","description":"Internal IP where beacon is executing.","example":"123.22.11.200"},"external":{"type":"string","description":"External IP where beacon is executing.","example":"168.1.11.128"},"os":{"type":"string","description":"Hosts operating system.","example":"Windows"},"version":{"type":"string","description":"Hosts operating system version.","example":10.0},"build":{"type":"integer","format":"int32","description":"Hosts operating system build number.","example":19045},"charset":{"type":"string","description":"Specifies the character encoding used to interpret or store text data.","example":"windows-1252"},"systemArch":{"type":"string","description":"The CPU architecture of the host system as x86 or x64.","enum":["x86","x64"],"example":"x64"},"beaconArch":{"type":"string","description":"The bitness of the process where beacon is running as x86 or x64.","enum":["x86","x64"],"example":"x64"},"session":{"type":"string","description":"The type of session beacon is running as beacon or ssh.","example":"beacon"},"listener":{"type":"string","description":"The egress listener name beacon is communicating with.","example":"https"},"pivotHint":{"type":"string","description":"The pivot hints for pivot beacons only","example":"345, TCP (FWD)"},"port":{"type":"integer","format":"int32","description":"The port number for ssh beacons only","example":6789},"note":{"type":"string","description":"The note associated with the beacon"},"color":{"type":"string","description":"The color associated with the beacon","enum":["DEFAULT","GREEN","PINK","YELLOW","GRAY","BLUE"],"example":"DEFAULT"},"alive":{"type":"boolean","description":"A flag indicating beacon is still active","example":true},"linkState":{"type":"string","description":"The status of a link for a pivot beacon.","enum":["NONE","GOOD","BROKEN"],"example":"GOOD"},"lastCheckinTime":{"type":"string","format":"date-time","description":"The time stamp for the last check-in for the beacon"},"lastCheckinMs":{"type":"integer","format":"int64","description":"The difference in time in milliseconds between the last check-in and now.","example":300000},"lastCheckinFormatted":{"type":"string","description":"The difference using a formated time between the last check-in and now.","example":"5m"},"sleep":{"$ref":"#/components/schemas/SleepDto"},"supportsSleep":{"type":"boolean","description":"A flag indicating that beacon supports the sleep command","example":true}},"required":["alive","bid","lastCheckinFormatted","lastCheckinMs","lastCheckinTime","session","sleep","supportsSleep"]},"RemoteExecInfoDto":{"type":"object","properties":{"name":{"type":"string"},"description":{"type":"string"}},"required":["name"]},"RemoteExploitInfoDto":{"type":"object","properties":{"name":{"type":"string"},"arch":{"type":"string","enum":["x86","x64"]},"description":{"type":"string"}},"required":["arch","name"]},"CommandHelpInfoDto":{"type":"object","properties":{"name":{"type":"string","minLength":1},"description":{"type":"string"},"details":{"type":"string"},"groups":{"type":"array","items":{"type":"string"}}},"required":["description","details","groups","name"]},"ElevatorInfoDto":{"type":"object","properties":{"name":{"type":"string"},"description":{"type":"string"}},"required":["name"]},"LocalExploitInfoDto":{"type":"object","properties":{"name":{"type":"string"},"description":{"type":"string"}},"required":["name"]},"DownloadProgressDto":{"type":"object","properties":{"name":{"type":"string"},"path":{"type":"string"},"size":{"type":"integer","format":"int64"},"received":{"type":"integer","format":"int64"}},"required":["name","path","received","size"]},"ArtifactDto":{"type":"object","properties":{"key":{"type":"string"},"symbolicReference":{"type":"string"}},"required":["key","symbolicReference"]},"SpoofedArgumentsRemoveDto":{"type":"object","properties":{"command":{"type":"string","minLength":1}},"required":["command"]},"HostCallbackRemoveDto":{"type":"object","properties":{"hostnames":{"type":"array","items":{"type":"string"},"minItems":1}},"required":["hostnames"]}},"securitySchemes":{"BearerAuthentication":{"type":"http","description":"Cobalt Strike API support the use of a bearer token in the `Authorization` HTTP header to authenticate with the API. You can generate a new one with your user and password using the /api/auth/login API endpoint","scheme":"bearer","bearerFormat":"JWT"}}}}